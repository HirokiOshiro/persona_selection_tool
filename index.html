<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>学生ペルソナ属性選択ツール</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 25%, #f1f5f9 50%, #e8f4f8 75%, #f8fafc 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4c63d2 0%, #667eea 50%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 8px;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .progress-section {
            background: #f8fafc;
            padding: 20px 30px;
            border-bottom: 1px solid #e2e8f0;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .progress-text {
            font-size: 14px;
            color: #64748b;
        }

        .progress-bar {
            background: #e2e8f0;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea, #764ba2, #667eea);
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
            width: 0%;
        }

        /* ペルソナ数選択セクション */
        .persona-count-section {
            background: #f8fafc;
            padding: 20px 30px;
            border-bottom: 1px solid #e2e8f0;
        }

        .persona-count-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .persona-count-header h3 {
            font-size: 18px;
            color: #1e293b;
            margin-bottom: 5px;
        }

        .persona-count-header p {
            font-size: 14px;
            color: #64748b;
            margin: 0;
        }

        .persona-count-buttons {
            display: flex;
            justify-content: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .persona-count-btn {
            padding: 10px 20px;
            border: 2px solid #e2e8f0;
            background: white;
            color: #64748b;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 60px;
        }

        .persona-count-btn:hover {
            border-color: #667eea;
            color: #667eea;
            transform: translateY(-1px);
        }

        .persona-count-btn.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-color: #667eea;
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .persona-count-btn:focus {
            outline: 2px solid #667eea;
            outline-offset: 2px;
        }

        /* ペルソナタブセクション */
        .persona-tabs-section {
            background: #f1f5f9;
            padding: 15px 30px 0;
            border-bottom: 1px solid #e2e8f0;
            display: none;
        }

        .persona-tabs-section.show {
            display: block;
        }

        .persona-tabs {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 15px;
            justify-content: center;
            align-items: center;
        }

        .persona-tab {
            padding: 12px 20px;
            border: none;
            background: #e2e8f0;
            color: #64748b;
            border-radius: 8px 8px 0 0;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
            position: relative;
            min-width: 120px;
        }

        .persona-tab:hover {
            background: #cbd5e1;
            color: #475569;
        }

        .persona-tab.active {
            background: white;
            color: #1e293b;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }

        .tab-progress {
            display: block;
            font-size: 12px;
            font-weight: 400;
            color: #64748b;
            margin-top: 2px;
        }

        .persona-tab.active .tab-progress {
            color: #667eea;
            font-weight: 500;
        }

        .persona-tab:focus {
            outline: 2px solid #667eea;
            outline-offset: 2px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            min-height: 600px;
        }

        .form-section {
            padding: 30px;
            overflow-y: auto;
            max-height: 80vh;
        }

        .attribute-group {
            margin-bottom: 40px;
            background: linear-gradient(135deg, #fff 0%, #f8fafc 100%);
            border-radius: 12px;
            padding: 24px;
            border-left: 4px solid #4f46e5;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .attribute-group:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .attribute-group[data-group="basic"] {
            border-left-color: #ff6b6b;
            background: linear-gradient(135deg, #fefefe 0%, #fffafa 100%);
        }

        .attribute-group[data-group="learning"] {
            border-left-color: #4ecdc4;
            background: linear-gradient(135deg, #fefefe 0%, #f9fffe 100%);
        }

        .attribute-group[data-group="psychology"] {
            border-left-color: #45b7d1;
            background: linear-gradient(135deg, #fefefe 0%, #fafcff 100%);
        }

        .attribute-group[data-group="relationships"] {
            border-left-color: #f9ca24;
            background: linear-gradient(135deg, #fefefe 0%, #fffef9 100%);
        }

        .attribute-group[data-group="growth"] {
            border-left-color: #6c5ce7;
            background: linear-gradient(135deg, #fefefe 0%, #fcfbff 100%);
        }

        .attribute-group[data-group="episodes"] {
            border-left-color: #fd79a8;
            background: linear-gradient(135deg, #fefefe 0%, #fffafc 100%);
        }

        .group-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .group-header:hover {
            color: #4f46e5;
        }

        .group-header h2 {
            font-size: 18px;
            color: #1e293b;
        }

        .group-icon {
            font-size: 20px;
        }

        .collapse-icon {
            margin-left: auto;
            font-size: 14px;
            transition: transform 0.3s ease;
        }

        .group-content {
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .group-content.collapsed {
            max-height: 0;
            margin-bottom: 0;
        }

        .option-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
            padding: 12px;
            border-radius: 8px;
            transition: all 0.2s;
            cursor: pointer;
        }

        .option-item:hover {
            background: #e0e7ff;
        }

        .option-item.selected {
            background: linear-gradient(135deg, #eef2ff, #e0e7ff);
            border: 2px solid #667eea;
            transform: scale(1.01);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        }

        .checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid #d1d5db;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            margin-top: 2px;
            transition: all 0.2s;
        }

        .checkbox.checked {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-color: #667eea;
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .checkbox.checked::after {
            content: '✓';
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .option-text {
            flex: 1;
            font-size: 14px;
            line-height: 1.4;
            color: #374151;
        }

        .option-main {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 2px;
        }

        .option-desc {
            color: #64748b;
            font-size: 13px;
        }

        .results-panel {
            background: linear-gradient(135deg, #fff 0%, #f0f9ff 50%, #fef3c7 100%);
            padding: 30px;
            border-left: 1px solid #e2e8f0;
            overflow-y: auto;
            max-height: 80vh;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
        }

        .results-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
        }

        .results-header h3 {
            color: #1e293b;
            font-size: 18px;
        }

        .selected-count {
            background: #4f46e5;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .results-content {
            font-size: 14px;
            line-height: 1.6;
        }

        .result-group {
            margin-bottom: 20px;
        }

        .result-group-title {
            font-weight: 600;
            color: #475569;
            margin-bottom: 8px;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .result-items {
            background: white;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
        }

        .result-item {
            padding: 4px 0;
            color: #64748b;
            font-size: 13px;
            border-bottom: 1px solid #f1f5f9;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: linear-gradient(90deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            background: linear-gradient(90deg, #4c63d2, #667eea);
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f1f5f9;
            color: #64748b;
            border: 1px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .completion-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #64748b;
        }

        .completion-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #e2e8f0;
        }

        .completion-dot.filled {
            background: #10b981;
        }

        .export-area {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }

        .export-textarea {
            width: 100%;
            height: 200px;
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 12px;
            font-family: monospace;
            resize: vertical;
            background: #f8fafc;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-number {
            font-size: 20px;
            font-weight: bold;
            color: #4f46e5;
        }

        .stat-label {
            font-size: 11px;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .search-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .search-toggle:hover {
            background: linear-gradient(135deg, #4c63d2, #667eea);
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .search-box {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 20px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.15);
            z-index: 999;
            transform: translateY(-100%);
            transition: transform 0.3s ease;
            border-bottom: 1px solid #e2e8f0;
        }

        .search-box.active {
            transform: translateY(0);
        }

        .search-container {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }

        .search-close {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            font-size: 24px;
            color: #64748b;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: color 0.2s;
        }

        .search-close:hover {
            color: #475569;
        }

        .search-input {
            width: 100%;
            padding: 12px 50px 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.2s;
        }

        .search-input:focus {
            border-color: #4f46e5;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #generation-message {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        /* 操作手順セクション */
        .instructions-section {
            background: linear-gradient(135deg, #f8fafc 0%, #e8f4f8 100%);
            padding: 20px 30px;
            border-bottom: 1px solid #e2e8f0;
        }

        .instructions-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            margin-bottom: 15px;
        }

        .instructions-title {
            display: flex;
            align-items: center;
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
        }

        .instructions-title span {
            margin-left: 8px;
        }

        .instructions-toggle {
            font-size: 18px;
            color: #64748b;
            transition: transform 0.2s ease;
        }

        .instructions-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .instructions-content.expanded {
            max-height: 300px;
        }

        .instructions-steps {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-top: 15px;
        }

        @media (max-width: 1200px) {
            .instructions-steps {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 600px) {
            .instructions-steps {
                grid-template-columns: 1fr;
            }
        }

        .instruction-step {
            background: white;
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .step-number {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            line-height: 24px;
            margin-right: 10px;
        }

        .step-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 4px;
            display: inline-block;
        }

        .step-description {
            font-size: 13px;
            color: #64748b;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .results-panel {
                border-left: none;
                border-top: 1px solid #e2e8f0;
                max-height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>学生ペルソナ属性選択ツール</h1>
            <p>選択した条件や背景を踏まえた学生ペルソナ生成用のプロンプトを作成します</p>
        </div>

        <!-- 操作手順セクション -->
        <div class="instructions-section">
            <div class="instructions-header" onclick="toggleInstructions()">
                <h3 class="instructions-title">
                    📋 <span>使い方ガイド</span>
                </h3>
                <div class="instructions-toggle" id="instructionsToggle">▼</div>
            </div>
            <div class="instructions-content expanded" id="instructionsContent">
                <div class="instructions-steps">
                    <div class="instruction-step">
                        <span class="step-number">1</span>
                        <div class="step-title">ペルソナ数を選択</div>
                        <div class="step-description">作成したいペルソナの数（1〜5名）を選択してください</div>
                    </div>
                    <div class="instruction-step">
                        <span class="step-number">2</span>
                        <div class="step-title">属性を選択</div>
                        <div class="step-description">各セクションから該当する属性を複数選択できます（居住形態は1つのみ）</div>
                    </div>
                    <div class="instruction-step">
                        <span class="step-number">3</span>
                        <div class="step-title">エピソードを記入</div>
                        <div class="step-description">必要に応じて具体的なエピソードを自由記述欄に入力してください</div>
                    </div>
                    <div class="instruction-step">
                        <span class="step-number">4</span>
                        <div class="step-title">プロンプトを生成</div>
                        <div class="step-description">「プロンプト生成」ボタンでAI用の指示文を作成し、コピーして利用してください</div>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 12px; background: rgba(102, 126, 234, 0.1); border-radius: 8px; font-size: 13px; color: #475569;">
                    💡 <strong>便利機能:</strong> 「ランダム選択」で自動選択、右側のパネルで選択状況を確認、データは自動保存されます
                </div>
            </div>
        </div>

        <!-- ペルソナ数選択セクション -->
        <div class="persona-count-section">
            <div class="persona-count-header" id="persona-count-header">
                <h3>👥 作成するペルソナ数を選択</h3>
                <p>最大5名分までのペルソナを一括作成するプロンプトを出力できます</p>
            </div>
            <div class="persona-count-buttons" role="radiogroup" aria-labelledby="persona-count-header">
                <button class="persona-count-btn active" data-count="1" onclick="setPersonaCount(1)" role="radio" aria-checked="true" aria-label="1名のペルソナを作成">1名</button>
                <button class="persona-count-btn" data-count="2" onclick="setPersonaCount(2)" role="radio" aria-checked="false" aria-label="2名のペルソナを作成">2名</button>
                <button class="persona-count-btn" data-count="3" onclick="setPersonaCount(3)" role="radio" aria-checked="false" aria-label="3名のペルソナを作成">3名</button>
                <button class="persona-count-btn" data-count="4" onclick="setPersonaCount(4)" role="radio" aria-checked="false" aria-label="4名のペルソナを作成">4名</button>
                <button class="persona-count-btn" data-count="5" onclick="setPersonaCount(5)" role="radio" aria-checked="false" aria-label="5名のペルソナを作成">5名</button>
            </div>
        </div>

        <!-- ペルソナタブセクション -->
        <div class="persona-tabs-section" id="personaTabsSection">
            <div class="persona-tabs" id="personaTabs" role="tablist" aria-label="ペルソナ選択">
                <button class="persona-tab active" data-persona="1" onclick="switchPersona(1)" role="tab" aria-selected="true" aria-controls="persona-content-1">
                    ペルソナ1
                    <span class="tab-progress" id="tabProgress1">0%</span>
                </button>
            </div>
        </div>

        <div class="progress-section">
            <div class="progress-info">
                <div class="progress-text">完成度: <span id="completionPercent">0%</span></div>
                <div class="completion-indicator">
                    <span>各属性の選択状況:</span>
                    <div class="completion-dot" data-group="basic"></div>
                    <div class="completion-dot" data-group="values"></div>
                    <div class="completion-dot" data-group="learning"></div>
                    <div class="completion-dot" data-group="relationships"></div>
                    <div class="completion-dot" data-group="growth"></div>
                    <div class="completion-dot" data-group="episodes"></div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <button class="search-toggle" onclick="toggleSearch()" id="searchToggle" aria-label="検索を開く" title="属性の検索">
            🔍
        </button>

        <div class="search-box" id="searchBox">
            <div class="search-container">
                <input type="text" class="search-input" placeholder="属性や内容で検索..." id="searchInput" aria-label="属性検索">
                <button class="search-close" onclick="closeSearch()" aria-label="検索を閉じる">×</button>
            </div>
        </div>

        <div class="main-content">
            <div class="form-section" role="main" aria-label="ペルソナ属性選択フォーム" id="persona-content-1">

                <!-- 基本属性と生活背景 -->
                <div class="attribute-group" data-group="basic">
                    <div class="group-header" onclick="toggleGroup(this)">
                        <span class="group-icon">🏠</span>
                        <h2>基本属性と生活背景</h2>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="group-content collapsed">
                        <!-- 学年・所属 -->
                        <h3 style="margin: 16px 0 12px 0; color: #475569; font-size: 14px;">🎯 学年・所属</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="1年生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">1年生</div>
                                <div class="option-desc">入学したばかりで大学に慣れようとしている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="2年生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">2年生</div>
                                <div class="option-desc">大学生活に慣れ、専門分野を模索中</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="3年生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">3年生</div>
                                <div class="option-desc">就活や将来を意識し始めて焦りを感じている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="4年生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">4年生</div>
                                <div class="option-desc">卒業が見えてきて次のステップを考えている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="大学院生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">大学院生</div>
                                <div class="option-desc">より専門的な学びに集中している</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="正規留学生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">正規留学生</div>
                                <div class="option-desc">学位取得のため正規課程に在籍している外国人学生</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="留年生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">留年生</div>
                                <div class="option-desc">挫折を経験し立て直しを図っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="編入生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">編入生</div>
                                <div class="option-desc">他大学や短大から編入し新しい環境に適応中</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="転学部生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">転学部生</div>
                                <div class="option-desc">学部を変更し新たな専門分野に挑戦中</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="休学復帰生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">休学復帰生</div>
                                <div class="option-desc">一度休学し復帰してやり直している</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="社会人学生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">社会人学生</div>
                                <div class="option-desc">働きながら学び直しをしている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="交換留学生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">交換留学生</div>
                                <div class="option-desc">異文化環境で学んでいる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="聴講生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">聴講生</div>
                                <div class="option-desc">正規学生ではないが興味のある授業を受けている</div>
                            </div>
                        </div>

                        <!-- 居住形態（択一式） -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">🏠 居住形態 <span style="font-size: 12px; color: #ef4444;">（1つのみ選択）</span></h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="実家暮らし（安心型）" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">実家暮らし（安心型）</div>
                                <div class="option-desc">家族と一緒で安心だが自立への憧れもある</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="一人暮らし（自由型）" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">一人暮らし（自由型）</div>
                                <div class="option-desc">自由だが時々孤独感や経済的不安もある</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="学生寮" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">学生寮</div>
                                <div class="option-desc">同世代との共同生活で刺激が多い</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="シェアハウス" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">シェアハウス</div>
                                <div class="option-desc">多様な人との交流を楽しんでいる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="一人暮らし（忙殺型）" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">一人暮らし（忙殺型）</div>
                                <div class="option-desc">家事や金銭管理が大変で勉強時間が削られがち</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="実家暮らし（通学困難型）" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">実家暮らし（通学困難型）</div>
                                <div class="option-desc">通学時間が長く疲れるが家族のサポートは心強い</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="親戚宅" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">親戚宅</div>
                                <div class="option-desc">複雑な家庭事情の中で頑張っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="下宿" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">下宿</div>
                                <div class="option-desc">アパートより安いが規則やプライバシーに制約がある</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="祖父母宅" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">祖父母宅</div>
                                <div class="option-desc">祖父母の面倒を見ながら大学に通っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="パートナーとの同居" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">パートナーとの同居</div>
                                <div class="option-desc">恋人と一緒に住んでいる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="友人との同居" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">友人との同居</div>
                                <div class="option-desc">気の合う友人と住居をシェアしている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="家族の介護のため実家" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">家族の介護のため実家</div>
                                <div class="option-desc">家族のサポートが必要で実家に残っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="海外" data-exclusive="residence">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">海外</div>
                                <div class="option-desc">留学や国際的な家庭環境で海外に住んでいる</div>
                            </div>
                        </div>

                        <!-- 経済状況 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">💰 経済状況</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="経済的余裕あり">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">経済的余裕あり</div>
                                <div class="option-desc">お金の心配はほとんどない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="奨学金利用">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">奨学金利用</div>
                                <div class="option-desc">将来の返済が少し気になる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="アルバイト必須">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">アルバイト必須</div>
                                <div class="option-desc">生活費や学費のためにバイトが欠かせない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="奨学金＋バイト">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">奨学金＋バイト</div>
                                <div class="option-desc">経済的にかなりタイトで時間管理が大変</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="家庭の事情で仕送り減額">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">家庭の事情で仕送り減額</div>
                                <div class="option-desc">急に経済状況が変わって戸惑っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="特待生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">特待生</div>
                                <div class="option-desc">学業成績を維持するプレッシャーを感じている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="家庭内の経済格差">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">家庭内の経済格差</div>
                                <div class="option-desc">周囲との生活レベルの違いを意識する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="親の事業失敗">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">親の事業失敗</div>
                                <div class="option-desc">家計が急変し経済的困窮に陥っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="自分でビジネス">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">自分でビジネス</div>
                                <div class="option-desc">起業やフリーランスで収入を得ている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="投資収入">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">投資収入</div>
                                <div class="option-desc">株や暗号通貨などで資産運用をしている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="仕送り完全停止">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">仕送り完全停止</div>
                                <div class="option-desc">親との関係悪化で経済的に完全自立</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="家族の医療・介護費用">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">家族の医療・介護費用</div>
                                <div class="option-desc">家族の病気で家計が圧迫されている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="海外からの送金">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">海外からの送金</div>
                                <div class="option-desc">国際的な家庭で複雑な経済状況</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="教育ローン利用">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">教育ローン利用</div>
                                <div class="option-desc">奨学金以外の借入で学費を賄っている</div>
                            </div>
                        </div>

                        <!-- 家族関係 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">👨‍👩‍👧‍👦 家族関係</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="放任主義">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">放任主義</div>
                                <div class="option-desc">自由にやらせてもらえるが時々寂しい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="教育熱心">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">教育熱心</div>
                                <div class="option-desc">期待をかけられているがプレッシャーも感じる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="過保護気味">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">過保護気味</div>
                                <div class="option-desc">心配されすぎて自立したい気持ちが強い</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="兄弟姉妹と比較される">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">兄弟姉妹と比較される</div>
                                <div class="option-desc">「お兄ちゃんは...」などと言われがち</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="長子として期待大">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">長子として期待大</div>
                                <div class="option-desc">弟妹の面倒も見なければならない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="一人っ子">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">一人っ子</div>
                                <div class="option-desc">自分だけに注目が集まり重荷に感じる時がある</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="親が単身赴任">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">親が単身赴任</div>
                                <div class="option-desc">家族の時間が少なく関係が希薄</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="複雑な家庭事情">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">複雑な家庭事情</div>
                                <div class="option-desc">両親の不仲や離婚などがあり心理的負担</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="ステップファミリー">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">ステップファミリー</div>
                                <div class="option-desc">再婚家庭で新しい家族関係を構築中</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="養子・里親家庭">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">養子・里親家庭</div>
                                <div class="option-desc">血縁でない家族との特別な絆がある</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="国際結婚家庭">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">国際結婚家庭</div>
                                <div class="option-desc">異文化が混在する家庭環境で育った</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="祖父母との三世代同居">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">祖父母との三世代同居</div>
                                <div class="option-desc">伝統的価値観と現代的価値観の狭間</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="きょうだいの障害">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">きょうだいの障害</div>
                                <div class="option-desc">家族のサポートが必要な状況がある</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="親の海外長期赴任">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">親の海外長期赴任</div>
                                <div class="option-desc">家族が離ればなれで暮らしている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="母子・父子家庭">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">母子・父子家庭</div>
                                <div class="option-desc">片親との深い絆と経済的な苦労</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="家族間の文化的差異">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">家族間の文化的差異</div>
                                <div class="option-desc">世代間で価値観が大きく異なる</div>
                            </div>
                        </div>

                        <!-- 基本的性格 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">🎭 基本的性格</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="外向的で社交的">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">外向的で社交的</div>
                                <div class="option-desc">人といるとエネルギーが湧いてくる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="内向的で思索好き">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">内向的で思索好き</div>
                                <div class="option-desc">一人の時間が大切で深く考えたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="完璧主義">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">完璧主義</div>
                                <div class="option-desc">中途半端が嫌いで納得いくまでやりたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="楽観的">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">楽観的</div>
                                <div class="option-desc">「なんとかなる」精神で前向きに考えがち</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="心配性">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">心配性</div>
                                <div class="option-desc">「もし○○だったら...」と不安になりやすい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="几帳面">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">几帳面</div>
                                <div class="option-desc">計画通りに進めたいが融通が利かない時もある</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="自由奔放">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">自由奔放</div>
                                <div class="option-desc">型にはまるのが嫌いで自分らしさを大切にする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="優柔不断">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">優柔不断</div>
                                <div class="option-desc">選択肢があると迷ってしまい決められない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="負けず嫌い">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">負けず嫌い</div>
                                <div class="option-desc">競争や比較されると燃えるタイプ</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="協調性重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">協調性重視</div>
                                <div class="option-desc">チームワークを大切にし調和を保とうとする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="創造性豊か">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">創造性豊か</div>
                                <div class="option-desc">新しいアイデアを生み出すことが得意</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="論理的思考">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">論理的思考</div>
                                <div class="option-desc">筋道立てて考えることを重視する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="責任感が強い">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">責任感が強い</div>
                                <div class="option-desc">任されたことは最後までやり遂げたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="冒険心旺盛">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">冒険心旺盛</div>
                                <div class="option-desc">新しいことや未知のことに積極的に挑戦</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="慎重派">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">慎重派</div>
                                <div class="option-desc">リスクを十分検討してから行動したい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="感情表現豊か">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">感情表現豊か</div>
                                <div class="option-desc">喜怒哀楽をはっきり表に出すタイプ</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="感情抑制型">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">感情抑制型</div>
                                <div class="option-desc">あまり感情を表に出さず冷静を保つ</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="フレキシブル">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">フレキシブル</div>
                                <div class="option-desc">状況に応じて柔軟に対応できる</div>
                            </div>
                        </div>

                        <!-- アルバイト状況 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">💼 アルバイト状況</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="アルバイト未経験">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">アルバイト未経験</div>
                                <div class="option-desc">まだ始めていないが興味はある</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="コンビニ・接客">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">コンビニ・接客</div>
                                <div class="option-desc">シフト制で規則正しく働いている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="飲食店">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">飲食店</div>
                                <div class="option-desc">忙しいが接客スキルやチームワークを学んでいる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="塾講師">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">塾講師</div>
                                <div class="option-desc">教える経験を通じて成長を感じている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="事務・データ入力">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">事務・データ入力</div>
                                <div class="option-desc">地味だが確実で集中力が身につく</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="イベントスタッフ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">イベントスタッフ</div>
                                <div class="option-desc">単発で自由度が高いが収入が不安定</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="専門性活かした仕事">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">専門性活かした仕事</div>
                                <div class="option-desc">将来に直結するスキルを磨いている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="複数掛け持ち">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">複数掛け持ち</div>
                                <div class="option-desc">時間管理が大変だが経験の幅が広がる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="家庭教師">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">家庭教師</div>
                                <div class="option-desc">責任が重いが生徒の成長にやりがいを感じる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="在宅ワーク">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">在宅ワーク</div>
                                <div class="option-desc">自宅でライティングやデザインなどを行っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="フリーランス">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">フリーランス</div>
                                <div class="option-desc">個人で受注し自分のペースで働いている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="長期インターンシップ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">長期インターンシップ</div>
                                <div class="option-desc">企業で実務経験を積んでいる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="家業手伝い">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">家業手伝い</div>
                                <div class="option-desc">家族のビジネスを手伝っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="アルバイト禁止">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">アルバイト禁止</div>
                                <div class="option-desc">親の方針や奨学金の条件で働けない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="研究アシスタント">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">研究アシスタント</div>
                                <div class="option-desc">大学の研究室でアルバイトしている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="自分でビジネス">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">自分でビジネス</div>
                                <div class="option-desc">起業やネットビジネスで収入を得ている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="ボランティア中心">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">ボランティア中心</div>
                                <div class="option-desc">無償だが社会貢献活動に力を入れている</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 価値観・判断基準 -->
                <div class="attribute-group" data-group="values">
                    <div class="group-header" onclick="toggleGroup(this)">
                        <span class="group-icon">💭</span>
                        <h2>価値観・判断の基準</h2>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="group-content collapsed">
                        <!-- 将来への考え方 -->
                        <h3 style="margin: 16px 0 12px 0; color: #475569; font-size: 14px;">🎯 将来への考え方</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="明確なビジョンあり">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">明確なビジョンあり</div>
                                <div class="option-desc">やりたいことがはっきりしている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="漠然とした不安">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">漠然とした不安</div>
                                <div class="option-desc">将来が見えずモヤモヤしている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="複数の選択肢で迷い中">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">複数の選択肢で迷い中</div>
                                <div class="option-desc">どれも魅力的で決められない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="安定志向">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">安定志向</div>
                                <div class="option-desc">リスクを避けて確実な道を歩みたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="挑戦志向">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">挑戦志向</div>
                                <div class="option-desc">多少リスクがあっても面白いことをやりたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="社会貢献重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">社会貢献重視</div>
                                <div class="option-desc">人の役に立つ仕事がしたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="自己実現重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">自己実現重視</div>
                                <div class="option-desc">自分らしさを活かせる道を探している</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="経済的成功重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">経済的成功重視</div>
                                <div class="option-desc">収入や地位を重視して選択したい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="ワークライフバランス重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">ワークライフバランス重視</div>
                                <div class="option-desc">プライベートも大切にしたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="まだ考えられない">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">まだ考えられない</div>
                                <div class="option-desc">将来のことは後回しにしがち</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="海外志向">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">海外志向</div>
                                <div class="option-desc">国際的な環境で働きたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="起業志向">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">起業志向</div>
                                <div class="option-desc">自分でビジネスを立ち上げたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="フリーランス志向">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">フリーランス志向</div>
                                <div class="option-desc">組織に属さず自由に働きたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="公務員志向">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">公務員志向</div>
                                <div class="option-desc">社会の基盤を支える仕事がしたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="継続学習志向">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">継続学習志向</div>
                                <div class="option-desc">生涯にわたって学び続けたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="地域貢献志向">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">地域貢献志向</div>
                                <div class="option-desc">地元や特定地域の発展に貢献したい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="環境保護志向">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">環境保護志向</div>
                                <div class="option-desc">持続可能な社会作りに関わりたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="専門家志向">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">専門家志向</div>
                                <div class="option-desc">特定分野の専門性を極めたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="多様性追求">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">多様性追求</div>
                                <div class="option-desc">色々な経験を積みたい</div>
                            </div>
                        </div>

                        <!-- 自分らしさの意識 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">💭 自分らしさの意識</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="明確に語れる">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">明確に語れる</div>
                                <div class="option-desc">「自分はこういう人間だ」と言える</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="迷いながら模索中">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">迷いながら模索中</div>
                                <div class="option-desc">「自分らしさって何だろう」と考え続けている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="他者との比較で混乱">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">他者との比較で混乱</div>
                                <div class="option-desc">周りを見すぎて自分を見失いがち</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="複数の自分が存在">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">複数の自分が存在</div>
                                <div class="option-desc">場面によって違う自分になっている感覚</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="文化的適応の悩み">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">文化的適応の悩み</div>
                                <div class="option-desc">出身国の文化と日本の文化の間で自分の立ち位置に迷っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="変化している最中">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">変化している最中</div>
                                <div class="option-desc">昔の自分と今の自分が違って戸惑っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="他者からの評価に左右される">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">他者からの評価に左右される</div>
                                <div class="option-desc">「○○な人だね」と言われると影響される</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="理想と現実のギャップ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">理想と現実のギャップ</div>
                                <div class="option-desc">なりたい自分と今の自分の差を感じる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="まだよくわからない">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">まだよくわからない</div>
                                <div class="option-desc">自分について考える機会があまりない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="文化的アイデンティティ重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">文化的アイデンティティ重視</div>
                                <div class="option-desc">出身地や文化的背景を大切にしている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="ジェンダーアイデンティティ模索">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">ジェンダーアイデンティティ模索</div>
                                <div class="option-desc">性別役割や性的指向について考えている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="役割アイデンティティ強い">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">役割アイデンティティ強い</div>
                                <div class="option-desc">学生、子ども、友人などの役割で自分を定義</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="能力への自信">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">能力への自信</div>
                                <div class="option-desc">得意なことを通じて自分らしさを感じる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="過去の経験が核">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">過去の経験が核</div>
                                <div class="option-desc">特定の体験が自分の基盤になっている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="価値観で定義">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">価値観で定義</div>
                                <div class="option-desc">何を大切にするかで自分を理解している</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="関係性で定義">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">関係性で定義</div>
                                <div class="option-desc">他者との関係の中で自分を見つけている</div>
                            </div>
                        </div>

                        <!-- 行動の選択基準 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">⚖️ 行動の選択基準</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="直感重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">直感重視</div>
                                <div class="option-desc">「なんとなく」の感覚を大切にする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="論理的判断">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">論理的判断</div>
                                <div class="option-desc">メリット・デメリットを整理して決める</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="周囲の意見重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">周囲の意見重視</div>
                                <div class="option-desc">家族や友人の意見を聞いてから決める</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="安全性優先">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">安全性優先</div>
                                <div class="option-desc">失敗のリスクが低い選択肢を選ぶ</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="成長重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">成長重視</div>
                                <div class="option-desc">自分の成長につながるかどうかで決める</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="興味関心優先">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">興味関心優先</div>
                                <div class="option-desc">面白そうかどうかで決める</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="人間関係重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">人間関係重視</div>
                                <div class="option-desc">一緒にいる人や築ける関係を重視する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="効率性重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">効率性重視</div>
                                <div class="option-desc">時間対効果を考えて最短ルートを選ぶ</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="社会的評価重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">社会的評価重視</div>
                                <div class="option-desc">世間体や評判を気にして決める</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="その場の気分">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">その場の気分</div>
                                <div class="option-desc">深く考えずにノリで決めることが多い</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="環境への配慮">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">環境への配慮</div>
                                <div class="option-desc">地球環境や持続可能性を考慮する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="倫理観重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">倫理観重視</div>
                                <div class="option-desc">道徳的に正しいかどうかを重視する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="美意識重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">美意識重視</div>
                                <div class="option-desc">美しさや洗練さを基準にする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="健康重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">健康重視</div>
                                <div class="option-desc">心身の健康への影響を考慮する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="時間的制約">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">時間的制約</div>
                                <div class="option-desc">利用可能な時間の範囲で決める</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="経済的制約">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">経済的制約</div>
                                <div class="option-desc">予算の範囲内で最良の選択をする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="過去の経験">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">過去の経験</div>
                                <div class="option-desc">以前の成功や失敗体験を参考にする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="将来への影響">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">将来への影響</div>
                                <div class="option-desc">長期的な結果を重視して決める</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 学習・知識スタンス -->
                <div class="attribute-group" data-group="learning">
                    <div class="group-header" onclick="toggleGroup(this)">
                        <span class="group-icon">📚</span>
                        <h2>学習・知識に対するスタンス</h2>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="group-content collapsed">
                        <!-- 大学の学びの捉え方 -->
                        <h3 style="margin: 16px 0 12px 0; color: #475569; font-size: 14px;">📚 大学の学びの捉え方</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="知的好奇心の場">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">知的好奇心の場</div>
                                <div class="option-desc">新しい知識に触れるのが純粋に楽しい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="単位取得手段">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">単位取得手段</div>
                                <div class="option-desc">とりあえず卒業できればいいと思っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="将来への投資">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">将来への投資</div>
                                <div class="option-desc">就職やキャリアに活かせることを重視</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="人間形成の場">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">人間形成の場</div>
                                <div class="option-desc">学問を通じて人として成長したい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="正解探しの場">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">正解探しの場</div>
                                <div class="option-desc">テストで良い点を取ることが主目的</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="疑問解決の場">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">疑問解決の場</div>
                                <div class="option-desc">日頃の「なぜ？」を解明したい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="仕方なく">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">仕方なく</div>
                                <div class="option-desc">親の期待もありとりあえず通っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="価値観形成の場">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">価値観形成の場</div>
                                <div class="option-desc">自分の考え方を確立したい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="ネットワーク構築の場">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">ネットワーク構築の場</div>
                                <div class="option-desc">友人や人脈作りが主目的</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="研究志向">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">研究志向</div>
                                <div class="option-desc">学問の最前線に触れ新しい発見をしたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="国際的視野">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">国際的視野</div>
                                <div class="option-desc">グローバルな視点や教養を身につけたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="実践的スキル重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">実践的スキル重視</div>
                                <div class="option-desc">社会で即戦力となるスキルを習得したい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="批判的思考重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">批判的思考重視</div>
                                <div class="option-desc">物事を多角的に検証する力を身につけたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="創造性重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">創造性重視</div>
                                <div class="option-desc">新しいアイデアを生み出す力を伸ばしたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="問題解決重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">問題解決重視</div>
                                <div class="option-desc">現実の課題を解決する方法を学びたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="専門性追求">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">専門性追求</div>
                                <div class="option-desc">特定分野の専門家になりたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="教養重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">教養重視</div>
                                <div class="option-desc">幅広い知識と教養を身につけたい</div>
                            </div>
                        </div>

                        <!-- 調べる・考える態度 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">🔍 調べる・考える態度</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="自発的に深掘り">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">自発的に深掘り</div>
                                <div class="option-desc">興味を持ったら徹底的に調べる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="必要最小限">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">必要最小限</div>
                                <div class="option-desc">課題で求められた範囲だけ調べる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="広く浅く">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">広く浅く</div>
                                <div class="option-desc">色々なことに手を出すが深くは掘り下げない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="体系的学習">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">体系的学習</div>
                                <div class="option-desc">基礎から順序立てて理解したい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="実践重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">実践重視</div>
                                <div class="option-desc">理論より実際にやってみることを大切にする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="批判的思考">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">批判的思考</div>
                                <div class="option-desc">情報を鵜呑みにせず多角的に検証する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="受動的">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">受動的</div>
                                <div class="option-desc">与えられた情報をそのまま受け取りがち</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="直感的理解">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">直感的理解</div>
                                <div class="option-desc">論理より感覚的に理解することが多い</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="人に聞く派">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">人に聞く派</div>
                                <div class="option-desc">自分で調べるより誰かに教えてもらいたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="創造的思考">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">創造的思考</div>
                                <div class="option-desc">既存の枠にとらわれず新しい発想で考える</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="協働的学習">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">協働的学習</div>
                                <div class="option-desc">他者と一緒に学ぶことで理解を深める</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="メンター重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">メンター重視</div>
                                <div class="option-desc">信頼できる指導者からの学びを大切にする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="実験的アプローチ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">実験的アプローチ</div>
                                <div class="option-desc">試行錯誤を通じて学んでいく</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="理論重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">理論重視</div>
                                <div class="option-desc">しっかりとした理論的基盤を築きたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="データ重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">データ重視</div>
                                <div class="option-desc">数値や事実に基づいて判断したい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="歴史的文脈重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">歴史的文脈重視</div>
                                <div class="option-desc">物事の背景や経緯を理解したい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="比較分析">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">比較分析</div>
                                <div class="option-desc">複数の情報を比較して理解を深める</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="視覚的学習">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">視覚的学習</div>
                                <div class="option-desc">図表や映像を使って理解したい</div>
                            </div>
                        </div>

                        <!-- わからないことへの対応 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">❓ わからないことへの対応</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="すぐに質問">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">すぐに質問</div>
                                <div class="option-desc">わからないことがあるとすぐ人に聞く</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="自力で解決">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">自力で解決</div>
                                <div class="option-desc">まずは自分で調べて考えてみる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="放置しがち">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">放置しがち</div>
                                <div class="option-desc">わからないことがあっても後回しにする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="不安になる">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">不安になる</div>
                                <div class="option-desc">理解できないと焦りや不安を感じる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="好奇心が湧く">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">好奇心が湧く</div>
                                <div class="option-desc">「なんで？」と興味深く感じる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="避けて通る">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">避けて通る</div>
                                <div class="option-desc">難しそうなことは最初から避ける</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="段階的アプローチ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">段階的アプローチ</div>
                                <div class="option-desc">少しずつ理解を積み重ねていく</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="諦めが早い">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">諦めが早い</div>
                                <div class="option-desc">少し考えてわからないとすぐ諦める</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="完璧主義">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">完璧主義</div>
                                <div class="option-desc">完全に理解するまで次に進みたくない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="試行錯誤アプローチ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">試行錯誤アプローチ</div>
                                <div class="option-desc">色々な方法を試してみる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="専門家に相談">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">専門家に相談</div>
                                <div class="option-desc">その分野の詳しい人に教えてもらう</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="時間をかけて考える">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">時間をかけて考える</div>
                                <div class="option-desc">じっくり時間をかけて考え抜く</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="複数の方法を試す">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">複数の方法を試す</div>
                                <div class="option-desc">一つがダメでも別の方法を探す</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="仲間と一緒に考える">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">仲間と一緒に考える</div>
                                <div class="option-desc">グループで議論しながら解決する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="基礎に立ち戻る">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">基礎に立ち戻る</div>
                                <div class="option-desc">わからない時は基本から見直す</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="実践で覚える">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">実践で覚える</div>
                                <div class="option-desc">理論より実際にやってみて覚える</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="類推で理解">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">類推で理解</div>
                                <div class="option-desc">似たような事例から推測して理解する</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 他者との関係 -->
                <div class="attribute-group" data-group="relationships">
                    <div class="group-header" onclick="toggleGroup(this)">
                        <span class="group-icon">🤝</span>
                        <h2>他者との関係</h2>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="group-content collapsed">
                        <!-- 期待を気にする相手 -->
                        <h3 style="margin: 16px 0 12px 0; color: #475569; font-size: 14px;">👥 期待を気にする相手</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="両親・家族">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">両親・家族</div>
                                <div class="option-desc">家族の期待に応えたいという気持ちが強い</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="教授・先生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">教授・先生</div>
                                <div class="option-desc">指導者からの評価を気にしている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="友人グループ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">友人グループ</div>
                                <div class="option-desc">仲間からどう思われるかが気になる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="特に誰も気にしない">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">特に誰も気にしない</div>
                                <div class="option-desc">他者の期待はあまり意識していない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="SNSのフォロワー">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">SNSのフォロワー</div>
                                <div class="option-desc">オンラインでの評価を意識している</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="恋人・パートナー">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">恋人・パートナー</div>
                                <div class="option-desc">パートナーの意見や期待を重視する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="先輩・後輩">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">先輩・後輩</div>
                                <div class="option-desc">縦の関係での立場を気にする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="世間一般">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">世間一般</div>
                                <div class="option-desc">社会的な「普通」や「常識」を意識する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="日本人学生">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">日本人学生</div>
                                <div class="option-desc">日本人学生に受け入れられたいと思っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="将来の自分">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">将来の自分</div>
                                <div class="option-desc">理想の自分像を意識して行動する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="メンター">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">メンター</div>
                                <div class="option-desc">人生の指導者や相談相手の期待を大切にする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="業界の人">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">業界の人</div>
                                <div class="option-desc">将来働きたい分野の専門家の評価を気にする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="憧れの人">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">憧れの人</div>
                                <div class="option-desc">尊敬する著名人や先輩の期待に応えたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="将来の家族">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">将来の家族</div>
                                <div class="option-desc">いつか持つかもしれない家族への責任を感じる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="同期・同学年">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">同期・同学年</div>
                                <div class="option-desc">同じ立場の人との比較を意識する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="故人">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">故人</div>
                                <div class="option-desc">亡くなった祖父母や親族の期待を感じている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="後続世代">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">後続世代</div>
                                <div class="option-desc">後輩や次世代への責任を感じている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="所属団体">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">所属団体</div>
                                <div class="option-desc">サークルや団体の一員としての責任を感じる</div>
                            </div>
                        </div>

                        <!-- 意見対立時の反応 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">💬 意見対立時の反応</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="積極的に議論">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">積極的に議論</div>
                                <div class="option-desc">異なる意見があっても話し合いたい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="対立回避">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">対立回避</div>
                                <div class="option-desc">争いになりそうなら引いてしまう</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="感情的になりがち">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">感情的になりがち</div>
                                <div class="option-desc">自分の意見を否定されると熱くなる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="冷静に分析">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">冷静に分析</div>
                                <div class="option-desc">相手の意見も客観的に検討する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="妥協点模索">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">妥協点模索</div>
                                <div class="option-desc">お互いが納得できる点を探そうとする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="黙り込む">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">黙り込む</div>
                                <div class="option-desc">何も言えなくなってしまう</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="表面的同調">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">表面的同調</div>
                                <div class="option-desc">本当は違うと思うが合わせてしまう</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="頑固に主張">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">頑固に主張</div>
                                <div class="option-desc">自分の意見を曲げたくない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="相手による">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">相手による</div>
                                <div class="option-desc">人によって反応が変わる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="創造的解決">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">創造的解決</div>
                                <div class="option-desc">新しい第三の選択肢を提案する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="第三者仲裁">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">第三者仲裁</div>
                                <div class="option-desc">中立的な人に判断を委ねる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="時間を置く">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">時間を置く</div>
                                <div class="option-desc">一度冷静になってから再度話し合う</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="権威に委ねる">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">権威に委ねる</div>
                                <div class="option-desc">専門家や上位者の判断を仰ぐ</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="データで説得">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">データで説得</div>
                                <div class="option-desc">客観的な事実や数値で説明する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="感情的共感">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">感情的共感</div>
                                <div class="option-desc">相手の気持ちを理解しようとする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="立場を変える">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">立場を変える</div>
                                <div class="option-desc">相手の視点に立って考えてみる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="ユーモアで和らげる">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">ユーモアで和らげる</div>
                                <div class="option-desc">笑いで場の空気を変える</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="長期戦略">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">長期戦略</div>
                                <div class="option-desc">時間をかけて徐々に理解を求める</div>
                            </div>
                        </div>

                        <!-- 相談・支援関係 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">🤝 相談・支援関係</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="一人で解決派">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">一人で解決派</div>
                                <div class="option-desc">他人に頼ることは少ない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="信頼できる人にのみ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">信頼できる人にのみ</div>
                                <div class="option-desc">特定の人だけに相談する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="誰にでも相談">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">誰にでも相談</div>
                                <div class="option-desc">困ったら周りの人に積極的に助けを求める</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="相談されることが多い">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">相談されることが多い</div>
                                <div class="option-desc">友人から頼られることが多い</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="与える派">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">与える派</div>
                                <div class="option-desc">人助けは好きだが自分は頼みにくい</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="依存しがち">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">依存しがち</div>
                                <div class="option-desc">困ったらすぐ人に頼ってしまう</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="相互支援">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">相互支援</div>
                                <div class="option-desc">お互いに支え合う関係を築いている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="表面的関係">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">表面的関係</div>
                                <div class="option-desc">深い相談はできない関係ばかり</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="孤立気味">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">孤立気味</div>
                                <div class="option-desc">相談できる相手がいない状態</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="専門家頼り">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">専門家頼り</div>
                                <div class="option-desc">カウンセラーや専門家に相談することが多い</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="オンラインコミュニティ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">オンラインコミュニティ</div>
                                <div class="option-desc">ネット上の仲間に相談する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="年上の人重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">年上の人重視</div>
                                <div class="option-desc">先輩や年長者のアドバイスを大切にする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="年下の人からも学ぶ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">年下の人からも学ぶ</div>
                                <div class="option-desc">後輩や年下からの意見も聞く</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="同性の友人重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">同性の友人重視</div>
                                <div class="option-desc">同じ性別の人に相談することが多い</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="異性の視点重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">異性の視点重視</div>
                                <div class="option-desc">違う性別の人の意見も参考にする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="家族外の関係">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">家族外の関係</div>
                                <div class="option-desc">家族以外の人との関係を重視する</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="匿名相談">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">匿名相談</div>
                                <div class="option-desc">身元を明かさずに相談することを好む</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="グループ相談">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">グループ相談</div>
                                <div class="option-desc">複数人での話し合いを好む</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 成長の兆し -->
                <div class="attribute-group" data-group="growth">
                    <div class="group-header" onclick="toggleGroup(this)">
                        <span class="group-icon">🌱</span>
                        <h2>セルフ・オーサーシップの兆し</h2>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="group-content collapsed">
                        <!-- 主体性の萌芽 -->
                        <h3 style="margin: 16px 0 12px 0; color: #475569; font-size: 14px;">🎯 主体性の萌芽</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="小さな決断の積み重ね">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">小さな決断の積み重ね</div>
                                <div class="option-desc">日常の選択を意識的にするようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="新しいことへの挑戦">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">新しいことへの挑戦</div>
                                <div class="option-desc">興味を持ったことに飛び込んでみた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="反対意見への表明">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">反対意見への表明</div>
                                <div class="option-desc">周りと違う意見でも言えるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="まだ実感なし">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">まだ実感なし</div>
                                <div class="option-desc">主体的に行動している実感はあまりない</div>
                            </div>
                        </div>

                        <!-- 現状への違和感・迷い -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">🤔 現状への違和感・迷い</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="強い違和感あり">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">強い違和感あり</div>
                                <div class="option-desc">「このままじゃダメだ」と常に思っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="時々違和感">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">時々違和感</div>
                                <div class="option-desc">ふとした時に「これでいいのかな」と思う</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="進路への迷い">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">進路への迷い</div>
                                <div class="option-desc">将来の選択肢で悩み続けている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="人間関係への疑問">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">人間関係への疑問</div>
                                <div class="option-desc">今の友人関係でいいのか迷っている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="学習方法への疑問">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">学習方法への疑問</div>
                                <div class="option-desc">今のやり方で成長できているか不安</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="自分の能力への疑問">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">自分の能力への疑問</div>
                                <div class="option-desc">本当にこれが自分の限界なのか</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="価値観の揺らぎ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">価値観の揺らぎ</div>
                                <div class="option-desc">今まで大切だと思っていたことへの疑問</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="特に迷いはない">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">特に迷いはない</div>
                                <div class="option-desc">今の状況に特に不満はない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="漠然とした不安">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">漠然とした不安</div>
                                <div class="option-desc">何がダメなのかわからないがモヤモヤする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="能力のミスマッチ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">能力のミスマッチ</div>
                                <div class="option-desc">自分の才能と現在の活動が合っていない気がする</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="環境への違和感">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">環境への違和感</div>
                                <div class="option-desc">今いる場所や環境が自分に合わない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="時代への疑問">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">時代への疑問</div>
                                <div class="option-desc">現代社会の価値観に疑問を感じる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="社会システムへの疑問">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">社会システムへの疑問</div>
                                <div class="option-desc">既存の制度や仕組みに違和感がある</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="ジェンダー役割への疑問">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">ジェンダー役割への疑問</div>
                                <div class="option-desc">性別による期待や役割に疑問を感じる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="競争社会への疑問">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">競争社会への疑問</div>
                                <div class="option-desc">競争重視の社会に違和感を感じる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="消費社会への疑問">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">消費社会への疑問</div>
                                <div class="option-desc">物質的豊かさ重視に疑問を感じる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="情報過多への疲れ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">情報過多への疲れ</div>
                                <div class="option-desc">SNSや情報の多さに疲れを感じる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="ライフスタイルへの疑問">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">ライフスタイルへの疑問</div>
                                <div class="option-desc">今の生活パターンでいいのか迷う</div>
                            </div>
                        </div>

                        <!-- 内的な葛藤 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">⚡ 内的な葛藤</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="親の期待 vs 自分の関心">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">親の期待 vs 自分の関心</div>
                                <div class="option-desc">家族の願いと自分の気持ちの間で揺れる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="安定 vs 挑戦">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">安定 vs 挑戦</div>
                                <div class="option-desc">安全な道と冒険したい気持ちで迷う</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="個人的成功 vs 社会貢献">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">個人的成功 vs 社会貢献</div>
                                <div class="option-desc">自分の利益と社会の役に立つことで迷う</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="友人関係 vs 個人の時間">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">友人関係 vs 個人の時間</div>
                                <div class="option-desc">人付き合いと一人の時間のバランス</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="完璧主義 vs 効率重視">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">完璧主義 vs 効率重視</div>
                                <div class="option-desc">丁寧さと速度のどちらを取るか</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="現実 vs 理想">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">現実 vs 理想</div>
                                <div class="option-desc">現実的な選択と理想的な選択の間で悩む</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="集団調和 vs 個人意見">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">集団調和 vs 個人意見</div>
                                <div class="option-desc">周りに合わせることと自分の意見を言うこと</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="特に葛藤はない">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">特に葛藤はない</div>
                                <div class="option-desc">内的な迷いはあまり感じていない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="過去 vs 未来">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">過去 vs 未来</div>
                                <div class="option-desc">これまでの経験と新しい可能性の間で迷う</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="地元 vs 都市部">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">地元 vs 都市部</div>
                                <div class="option-desc">故郷への愛着と都市部への憧れで迷う</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="伝統 vs 革新">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">伝統 vs 革新</div>
                                <div class="option-desc">古い価値観と新しい考え方の間で揺れる</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="自由 vs 責任">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">自由 vs 責任</div>
                                <div class="option-desc">やりたいことと義務感の間で悩む</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="個性 vs 調和">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">個性 vs 調和</div>
                                <div class="option-desc">自分らしさと周囲との協調性のバランス</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="競争 vs 協力">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">競争 vs 協力</div>
                                <div class="option-desc">勝つことと助け合うことの間で迷う</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="専門性 vs 汎用性">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">専門性 vs 汎用性</div>
                                <div class="option-desc">深く学ぶか幅広く学ぶかで迷う</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="短期的利益 vs 長期的成長">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">短期的利益 vs 長期的成長</div>
                                <div class="option-desc">目先のメリットと将来の成長のバランス</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="物質的豊かさ vs 精神的充実">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">物質的豊かさ vs 精神的充実</div>
                                <div class="option-desc">お金と心の豊かさのどちらを重視するか</div>
                            </div>
                        </div>

                        <!-- 変化・成長の兆し -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">🌱 変化・成長の兆し</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="自己主張が増えた">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">自己主張が増えた</div>
                                <div class="option-desc">以前より自分の意見を言えるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="質問が増えた">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">質問が増えた</div>
                                <div class="option-desc">「なぜ？」「どうして？」と思うことが多くなった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="選択に責任感">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">選択に責任感</div>
                                <div class="option-desc">自分で決めたことに責任を持とうとするようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="他者理解が深まった">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">他者理解が深まった</div>
                                <div class="option-desc">人それぞれ違うということがわかってきた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="失敗への耐性">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">失敗への耐性</div>
                                <div class="option-desc">うまくいかなくても立ち直れるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="長期的視点">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">長期的視点</div>
                                <div class="option-desc">目先のことだけでなく将来を考えるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="メタ認知の芽生え">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">メタ認知の芽生え</div>
                                <div class="option-desc">自分の思考パターンに気づくようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="特に変化なし">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">特に変化なし</div>
                                <div class="option-desc">以前と比べて大きな変化は感じていない</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="価値観の多様性認識">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">価値観の多様性認識</div>
                                <div class="option-desc">正解は一つじゃないとわかってきた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="身体的変化への気づき">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">身体的変化への気づき</div>
                                <div class="option-desc">健康や体力の変化を意識するようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="環境適応力の向上">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">環境適応力の向上</div>
                                <div class="option-desc">新しい環境にも対応できるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="創造性の発揮">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">創造性の発揮</div>
                                <div class="option-desc">新しいアイデアを生み出せるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="リーダーシップの芽生え">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">リーダーシップの芽生え</div>
                                <div class="option-desc">グループを引っ張ることができるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="共感力の向上">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">共感力の向上</div>
                                <div class="option-desc">他者の気持ちをより理解できるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="批判的思考の発達">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">批判的思考の発達</div>
                                <div class="option-desc">情報を鵜呑みにせず検証するようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="時間管理能力">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">時間管理能力</div>
                                <div class="option-desc">効率的に時間を使えるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="コミュニケーション能力">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">コミュニケーション能力</div>
                                <div class="option-desc">人との関わり方が上手になった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="学習方法の改善">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">学習方法の改善</div>
                                <div class="option-desc">自分に合った勉強法を見つけられるようになった</div>
                            </div>
                        </div>

                        <!-- 追加の主体性の萌芽項目 -->
                        <div class="option-item" onclick="toggleOption(this)" data-value="失敗から学ぶ姿勢">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">失敗から学ぶ姿勢</div>
                                <div class="option-desc">うまくいかなかった時の振り返りをするようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="リーダーシップ発揮">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">リーダーシップ発揮</div>
                                <div class="option-desc">グループの中で率先して行動するようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="創造的プロジェクト">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">創造的プロジェクト</div>
                                <div class="option-desc">自分でオリジナルな企画や作品を作るようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="社会活動参加">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">社会活動参加</div>
                                <div class="option-desc">ボランティアや社会問題に積極的に関わるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="国際的活動">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">国際的活動</div>
                                <div class="option-desc">海外との交流や国際的な視野を持つ活動を始めた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="起業的行動">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">起業的行動</div>
                                <div class="option-desc">小さなビジネスや事業を始めてみた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="研究活動">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">研究活動</div>
                                <div class="option-desc">自分の関心テーマについて深く調べるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="メンター関係の構築">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">メンター関係の構築</div>
                                <div class="option-desc">自分から師となる人を見つけて学ぶようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="専門性の追求">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">専門性の追求</div>
                                <div class="option-desc">特定分野で専門的な知識やスキルを身につけようとしている</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="コミュニティ形成">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">コミュニティ形成</div>
                                <div class="option-desc">同じ関心を持つ人とのネットワークを作るようになった</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- エピソード -->
                <div class="attribute-group" data-group="episodes">
                    <div class="group-header" onclick="toggleGroup(this)">
                        <span class="group-icon">📖</span>
                        <h2>具体的エピソード</h2>
                        <span class="collapse-icon">▶</span>
                    </div>
                    <div class="group-content collapsed">
                        <!-- エピソード1 -->
                        <h3 style="margin: 16px 0 12px 0; color: #475569; font-size: 14px;">📖 エピソード1：日常の意思決定</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="履修登録で迷った">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">履修登録で迷った</div>
                                <div class="option-desc">興味ある科目vs就活に有利な科目で悩んだ</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="サークル選択">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">サークル選択</div>
                                <div class="option-desc">複数の選択肢から自分に合うものを選んだ</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="一人暮らし開始">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">一人暮らし開始</div>
                                <div class="option-desc">親への依存から自立への大きな決断をした</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="アルバイト決定">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">アルバイト決定</div>
                                <div class="option-desc">時給vs勤務条件vs経験値で総合判断した</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="友人との約束">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">友人との約束</div>
                                <div class="option-desc">自分の都合と相手への配慮のバランスを取った</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="専攻分野決定">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">専攻分野決定</div>
                                <div class="option-desc">将来性と興味関心のバランスで決めた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="恋愛関係">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">恋愛関係</div>
                                <div class="option-desc">告白するかどうか自分の気持ちと向き合った</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="就活方針決定">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">就活方針決定</div>
                                <div class="option-desc">大手志向か自分らしさ重視かで方向性を決めた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="留学申請">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">留学申請</div>
                                <div class="option-desc">安全圏を出て挑戦することを決めた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="部活の役職">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">部活の役職</div>
                                <div class="option-desc">責任の重いポジションを引き受けることにした</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="家族の期待との向き合い">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">家族の期待との向き合い</div>
                                <div class="option-desc">親の意見と自分の考えの違いを認識した</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="転学部検討">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">転学部検討</div>
                                <div class="option-desc">現在の専攻に疑問を感じて方向転換を考えた</div>
                            </div>
                        </div>

                        <!-- エピソード1 自由記述欄 -->
                        <div style="margin: 20px 0; padding: 16px; background: #f8fafc; border-radius: 8px; border-left: 3px solid #fd79a8;">
                            <h4 style="margin: 0 0 8px 0; color: #475569; font-size: 13px; font-weight: 600;">✍️ エピソード1 自由記述</h4>
                            <textarea 
                                id="episode1Custom"
                                placeholder="日常の意思決定に関する具体的なエピソードがあれば自由に記述してください..."
                                style="width: 100%; height: 60px; padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 13px; resize: vertical; font-family: inherit;"
                            ></textarea>
                        </div>

                        <!-- エピソード2：学習・成長に関する場面 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">📚 エピソード2：学習・成長</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="難しい授業への挑戦">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">難しい授業への挑戦</div>
                                <div class="option-desc">ついていけるか不安だったが履修を決めた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="研究テーマ選択">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">研究テーマ選択</div>
                                <div class="option-desc">興味はあるが難易度の高いテーマに挑戦した</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="勉強方法の見直し">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">勉強方法の見直し</div>
                                <div class="option-desc">従来のやり方の限界を感じて変更した</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="日本語学習の壁">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">日本語学習の壁</div>
                                <div class="option-desc">授業や友人との会話で日本語の理解に苦労している</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="グループワーク">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">グループワーク</div>
                                <div class="option-desc">異なる意見を持つメンバーとの協働を経験した</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="質問する勇気">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">質問する勇気</div>
                                <div class="option-desc">わからないことを恥ずかしがらずに聞けるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="失敗からの学び">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">失敗からの学び</div>
                                <div class="option-desc">テストや課題の失敗から自分の弱点を発見した</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="新しい分野への挑戦">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">新しい分野への挑戦</div>
                                <div class="option-desc">専門外の領域に興味を持って学び始めた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="教える経験">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">教える経験</div>
                                <div class="option-desc">後輩や友人に教えることで自分の理解が深まった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="批判的思考の実践">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">批判的思考の実践</div>
                                <div class="option-desc">情報を鵜呑みにせず検証する習慣がついた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="長期目標の設定">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">長期目標の設定</div>
                                <div class="option-desc">卒業までの学習計画を自分で立てた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="国際的な学び">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">国際的な学び</div>
                                <div class="option-desc">海外の学生との交流で視野が広がった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="実践的学習">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">実践的学習</div>
                                <div class="option-desc">理論だけでなく実際の活動で学ぶ機会を得た</div>
                            </div>
                        </div>

                        <!-- エピソード2 自由記述欄 -->
                        <div style="margin: 20px 0; padding: 16px; background: #f8fafc; border-radius: 8px; border-left: 3px solid #fd79a8;">
                            <h4 style="margin: 0 0 8px 0; color: #475569; font-size: 13px; font-weight: 600;">✍️ エピソード2 自由記述</h4>
                            <textarea 
                                id="episode2Custom"
                                placeholder="学習・成長に関する具体的なエピソードがあれば自由に記述してください..."
                                style="width: 100%; height: 60px; padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 13px; resize: vertical; font-family: inherit;"
                            ></textarea>
                        </div>

                        <!-- エピソード3：他者との関係性が現れる場面 -->
                        <h3 style="margin: 24px 0 12px 0; color: #475569; font-size: 14px;">👥 エピソード3：他者との関係</h3>
                        <div class="option-item" onclick="toggleOption(this)" data-value="友人との意見対立">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">友人との意見対立</div>
                                <div class="option-desc">価値観の違いを認めつつ関係を維持した</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="リーダーシップ発揮">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">リーダーシップ発揮</div>
                                <div class="option-desc">グループをまとめる役割を担った</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="困っている人への支援">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">困っている人への支援</div>
                                <div class="option-desc">自分から手を差し伸べることができた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="相談を受けた経験">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">相談を受けた経験</div>
                                <div class="option-desc">友人の悩みを聞いて適切にアドバイスした</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="先輩との関係">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">先輩との関係</div>
                                <div class="option-desc">年上の人から学ぶ姿勢を身につけた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="後輩指導">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">後輩指導</div>
                                <div class="option-desc">年下の人に教える責任感を感じた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="恋愛関係の発展">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">恋愛関係の発展</div>
                                <div class="option-desc">パートナーとの深い関係を築いた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="家族関係の変化">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">家族関係の変化</div>
                                <div class="option-desc">親との関係が対等に近づいた</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="国際交流">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">国際交流</div>
                                <div class="option-desc">異文化の人との友情を育んだ</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="チームワーク">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">チームワーク</div>
                                <div class="option-desc">個人プレーからチーム重視に変わった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="孤立からの脱却">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">孤立からの脱却</div>
                                <div class="option-desc">一人でいることから人との繋がりを求めるようになった</div>
                            </div>
                        </div>
                        <div class="option-item" onclick="toggleOption(this)" data-value="新しいコミュニティ">
                            <div class="checkbox"></div>
                            <div class="option-text">
                                <div class="option-main">新しいコミュニティ</div>
                                <div class="option-desc">既存の人間関係を超えて新しい仲間を見つけた</div>
                            </div>
                        </div>

                        <!-- エピソード3 自由記述欄 -->
                        <div style="margin: 20px 0; padding: 16px; background: #f8fafc; border-radius: 8px; border-left: 3px solid #fd79a8;">
                            <h4 style="margin: 0 0 8px 0; color: #475569; font-size: 13px; font-weight: 600;">✍️ エピソード3 自由記述</h4>
                            <textarea 
                                id="episode3Custom"
                                placeholder="他者との関係に関する具体的なエピソードがあれば自由に記述してください..."
                                style="width: 100%; height: 60px; padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 13px; resize: vertical; font-family: inherit;"
                            ></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <div class="results-panel">
                <div class="results-header">
                    <h3>📊 選択結果</h3>
                    <div class="selected-count" id="selectedCount">0</div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="basicCount">0</div>
                        <div class="stat-label">基本属性と生活背景</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="valuesCount">0</div>
                        <div class="stat-label">価値観・判断の基準</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="learningCount">0</div>
                        <div class="stat-label">学習・知識に対するスタンス</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="relationshipsCount">0</div>
                        <div class="stat-label">他者との関係</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="growthCount">0</div>
                        <div class="stat-label">セルフ・オーサーシップの兆し</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="episodesCount">0</div>
                        <div class="stat-label">具体的エピソード</div>
                    </div>
                </div>

                <div class="results-content">
                    <div class="result-group" id="basicResults">
                        <div class="result-group-title">基本属性と生活背景</div>
                        <div class="result-items">
                            <div class="result-item">まだ選択されていません</div>
                        </div>
                    </div>
                    <div class="result-group" id="valuesResults">
                        <div class="result-group-title">価値観・判断の基準</div>
                        <div class="result-items">
                            <div class="result-item">まだ選択されていません</div>
                        </div>
                    </div>
                    <div class="result-group" id="learningResults">
                        <div class="result-group-title">学習・知識に対するスタンス</div>
                        <div class="result-items">
                            <div class="result-item">まだ選択されていません</div>
                        </div>
                    </div>
                    <div class="result-group" id="relationshipsResults">
                        <div class="result-group-title">他者との関係</div>
                        <div class="result-items">
                            <div class="result-item">まだ選択されていません</div>
                        </div>
                    </div>
                    <div class="result-group" id="growthResults">
                        <div class="result-group-title">セルフ・オーサーシップの兆し</div>
                        <div class="result-items">
                            <div class="result-item">まだ選択されていません</div>
                        </div>
                    </div>
                    <div class="result-group" id="episodesResults">
                        <div class="result-group-title">具体的エピソード</div>
                        <div class="result-items">
                            <div class="result-item">まだ選択されていません</div>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="generatePrompt()" id="generateBtn" disabled>
                        ✨ プロンプト生成
                    </button>
                    <button class="btn btn-secondary" onclick="randomSelection()" title="各属性から1-3項目をランダムに自動選択します">
                        🎲 ランダム選択
                    </button>
                    <button class="btn btn-secondary" onclick="clearAll()">
                        🗑️ リセット
                    </button>
                    <button class="btn btn-secondary" onclick="clearAllData()" style="background: #ef4444; border-color: #ef4444;">
                        🗑️ 全データ削除
                    </button>
                </div>

                <div style="margin-top: 12px; font-size: 12px; color: #64748b; text-align: center;">
                    💡 ヒント: ランダム選択で多様なペルソナパターンを発見できます
                </div>

                <div class="export-area" id="exportArea" style="display: none;">
                    <h4 style="margin-bottom: 12px; color: #475569;">🤖 生成AI用プロンプト</h4>
                    <p style="font-size: 12px; color: #64748b; margin-bottom: 12px; line-height: 1.4;">
                        下記のプロンプトをコピーして、ChatGPT・Claude・Gemini等の生成AIに貼り付けてください。<br>
                        選択した属性に基づいたリアルな大学生ペルソナが生成されます。
                    </p>
                    <textarea class="export-textarea" id="exportText" readonly></textarea>
                    <div style="display: flex; gap: 8px; margin-top: 8px;">
                        <button class="btn btn-primary" onclick="copyPrompt()" style="flex: 1;">
                            📋 プロンプトをコピー
                        </button>
                        <button class="btn btn-secondary" onclick="document.getElementById('exportArea').style.display='none'" style="flex: 0 0 auto;">
                            ✕
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 複数ペルソナ対応のデータ構造
        let personaCount = 1;
        let currentPersona = 1;
        let allPersonaData = {};

        // 初期化関数
        function initializePersonaData() {
            for (let i = 1; i <= 5; i++) {
                allPersonaData[i] = {
                    selections: {
                        basic: [],
                        values: [],
                        learning: [],
                        relationships: [],
                        growth: [],
                        episodes: []
                    },
                    episodes: {
                        episode1: '',
                        episode2: '',
                        episode3: ''
                    }
                };
            }
        }

        // 現在のペルソナのselections（深いコピーでクロスコンタミネーションを防ぐ）
        let selections = {};
        if (allPersonaData[currentPersona] && allPersonaData[currentPersona].selections) {
            Object.keys(allPersonaData[currentPersona].selections).forEach(key => {
                selections[key] = [...allPersonaData[currentPersona].selections[key]];
            });
        } else {
            selections = {
                basic: [],
                values: [],
                learning: [],
                relationships: [],
                growth: [],
                episodes: []
            };
        }

        // 初期化
        initializePersonaData();

        // ペルソナ数設定
        function setPersonaCount(count) {
            personaCount = count;
            
            // ボタンの状態更新
            document.querySelectorAll('.persona-count-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.setAttribute('aria-checked', 'false');
            });
            const activeBtn = document.querySelector(`[data-count="${count}"]`);
            activeBtn.classList.add('active');
            activeBtn.setAttribute('aria-checked', 'true');
            
            // タブセクションの表示/非表示
            const tabsSection = document.getElementById('personaTabsSection');
            if (count > 1) {
                tabsSection.classList.add('show');
                updatePersonaTabs();
            } else {
                tabsSection.classList.remove('show');
                // 1名の場合は1番ペルソナに切り替え
                switchPersona(1);
            }
            
            // データの保存
            saveToLocalStorage();
        }

        // ペルソナタブの更新
        function updatePersonaTabs() {
            const tabsContainer = document.getElementById('personaTabs');
            tabsContainer.innerHTML = '';
            
            for (let i = 1; i <= personaCount; i++) {
                const tab = document.createElement('button');
                tab.className = `persona-tab ${i === currentPersona ? 'active' : ''}`;
                tab.setAttribute('data-persona', i);
                tab.setAttribute('role', 'tab');
                tab.setAttribute('aria-selected', i === currentPersona ? 'true' : 'false');
                tab.setAttribute('aria-controls', `persona-content-${i}`);
                tab.setAttribute('id', `persona-tab-${i}`);
                tab.onclick = () => switchPersona(i);
                
                const progress = calculatePersonaProgress(i);
                tab.innerHTML = `
                    ペルソナ${i}
                    <span class="tab-progress" id="tabProgress${i}">${progress}%</span>
                `;
                
                tabsContainer.appendChild(tab);
            }
        }

        // ペルソナ切り替え
        function switchPersona(personaNum) {
            if (personaNum < 1 || personaNum > personaCount) return;
            
            // 現在のデータを保存
            saveCurrentPersonaData();
            
            // ペルソナ切り替え
            currentPersona = personaNum;
            // 選択データの深いコピーを作成してクロスコンタミネーションを防ぐ
            selections = {};
            Object.keys(allPersonaData[currentPersona].selections).forEach(key => {
                selections[key] = [...allPersonaData[currentPersona].selections[key]];
            });
            
            // UI更新
            updateUIForCurrentPersona();
            updatePersonaTabs();
            updateProgress();
            
            // ローカルストレージに保存
            saveToLocalStorage();
        }

        // 現在のペルソナデータを保存
        function saveCurrentPersonaData() {
            // 深いコピーを作成してクロスコンタミネーションを完全に防ぐ
            const selectionsClone = {};
            Object.keys(selections).forEach(key => {
                selectionsClone[key] = [...selections[key]];
            });
            allPersonaData[currentPersona].selections = selectionsClone;
            
            // 自由記述欄の保存
            const episode1 = document.getElementById('episode1Custom')?.value || '';
            const episode2 = document.getElementById('episode2Custom')?.value || '';
            const episode3 = document.getElementById('episode3Custom')?.value || '';
            
            allPersonaData[currentPersona].episodes = {
                episode1: episode1,
                episode2: episode2,
                episode3: episode3
            };
        }

        // 現在のペルソナに合わせてUIを更新
        function updateUIForCurrentPersona() {
            // すべての選択をクリア
            document.querySelectorAll('.option-item').forEach(item => {
                item.classList.remove('selected');
                const checkbox = item.querySelector('.checkbox');
                if (checkbox) {
                    checkbox.innerHTML = '';
                }
            });
            
            // 現在のペルソナの選択を反映
            const currentSelections = allPersonaData[currentPersona].selections;
            Object.keys(currentSelections).forEach(category => {
                currentSelections[category].forEach(value => {
                    // CSS セレクタの特殊文字をエスケープ
                    const escapedValue = value.replace(/[\(\)]/g, '\\$&');
                    const item = document.querySelector(`[data-value="${escapedValue}"]`);
                    if (item) {
                        item.classList.add('selected');
                        const checkbox = item.querySelector('.checkbox');
                        if (checkbox) {
                            checkbox.innerHTML = '✓';
                        }
                    } else {
                        // フォールバック: 全ての要素を調べて直接比較
                        const allItems = document.querySelectorAll('.option-item');
                        for (let optionItem of allItems) {
                            if (optionItem.dataset.value === value) {
                                optionItem.classList.add('selected');
                                const checkbox = optionItem.querySelector('.checkbox');
                                if (checkbox) {
                                    checkbox.innerHTML = '✓';
                                }
                                break;
                            }
                        }
                    }
                });
            });
            
            // 自由記述欄の復元
            const episodes = allPersonaData[currentPersona].episodes;
            const episode1Input = document.getElementById('episode1Custom');
            const episode2Input = document.getElementById('episode2Custom');
            const episode3Input = document.getElementById('episode3Custom');
            
            if (episode1Input) episode1Input.value = episodes.episode1 || '';
            if (episode2Input) episode2Input.value = episodes.episode2 || '';
            if (episode3Input) episode3Input.value = episodes.episode3 || '';
        }

        // ペルソナの進捗計算
        function calculatePersonaProgress(personaNum) {
            const personaData = allPersonaData[personaNum];
            if (!personaData) return 0;
            
            // 6つのカテゴリーそれぞれで選択があるかチェック（各カテゴリー最大16.67%）
            const categories = ['basic', 'values', 'learning', 'relationships', 'growth', 'episodes'];
            const categoriesWithSelections = categories.filter(cat => 
                personaData.selections[cat] && personaData.selections[cat].length > 0
            ).length;
            
            // 3つのエピソードで記述があるかチェック（各エピソード最大16.67%）
            const episodes = personaData.episodes || {};
            const episodesWithContent = Object.values(episodes).filter(ep => 
                ep && ep.trim().length > 0
            ).length;
            
            // 全体の進捗（カテゴリー6個 + エピソード3個 = 9個の要素）
            const totalElements = 9;
            const completedElements = categoriesWithSelections + episodesWithContent;
            
            return Math.min(100, Math.round((completedElements / totalElements) * 100));
        }

        // LocalStorageに保存
        function saveToLocalStorage() {
            try {
                const dataToSave = {
                    personaCount: personaCount,
                    currentPersona: currentPersona,
                    allPersonaData: allPersonaData,
                    lastUpdated: new Date().toISOString()
                };
                localStorage.setItem('personaToolData', JSON.stringify(dataToSave));
            } catch (error) {
                console.warn('データの保存に失敗しました:', error);
            }
        }

        // LocalStorageから復元
        function loadFromLocalStorage() {
            try {
                const savedData = localStorage.getItem('personaToolData');
                if (savedData) {
                    const parsed = JSON.parse(savedData);
                    personaCount = parsed.personaCount || 1;
                    currentPersona = parsed.currentPersona || 1;
                    allPersonaData = parsed.allPersonaData || {};
                    
                    // 不完全なデータの補完
                    for (let i = 1; i <= 5; i++) {
                        if (!allPersonaData[i]) {
                            allPersonaData[i] = {
                                selections: {
                                    basic: [],
                                    values: [],
                                    learning: [],
                                    relationships: [],
                                    growth: [],
                                    episodes: []
                                },
                                episodes: {
                                    episode1: '',
                                    episode2: '',
                                    episode3: ''
                                }
                            };
                        }
                    }
                    
                    // selectionsの参照を更新
                    selections = allPersonaData[currentPersona].selections;
                    
                    // UI更新
                    setPersonaCount(personaCount);
                    updateUIForCurrentPersona();
                    updateProgress();
                    
                    // データ復元完了
                    return true;
                }
            } catch (error) {
                console.warn('データの復元に失敗しました:', error);
            }
            return false;
        }

        // データクリア機能
        function clearAllData() {
            if (confirm('すべてのペルソナデータをクリアしますか？この操作は取り消せません。')) {
                localStorage.removeItem('personaToolData');
                location.reload();
            }
        }

        function toggleGroup(header) {
            const content = header.nextElementSibling;
            const icon = header.querySelector('.collapse-icon');
            
            content.classList.toggle('collapsed');
            icon.textContent = content.classList.contains('collapsed') ? '▶' : '▼';
        }

        // すべてのセクションを展開する関数
        function expandAllSections() {
            document.querySelectorAll('.group-header').forEach(header => {
                const content = header.nextElementSibling;
                const icon = header.querySelector('.collapse-icon');
                
                if (content && content.classList.contains('collapsed')) {
                    content.classList.remove('collapsed');
                    if (icon) {
                        icon.textContent = '▼';
                    }
                }
            });
        }

        // 操作手順セクションの開閉機能
        function toggleInstructions() {
            const content = document.getElementById('instructionsContent');
            const toggle = document.getElementById('instructionsToggle');
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                toggle.textContent = '▶';
                toggle.style.transform = 'rotate(0deg)';
            } else {
                content.classList.add('expanded');
                toggle.textContent = '▼';
                toggle.style.transform = 'rotate(0deg)';
            }
        }

        function toggleOption(element) {
            const checkbox = element.querySelector('.checkbox');
            const value = element.dataset.value;
            const group = element.closest('.attribute-group').dataset.group;
            const exclusiveGroup = element.dataset.exclusive;
            
            if (element.classList.contains('selected')) {
                // 選択解除
                checkbox.innerHTML = '';
                element.classList.remove('selected');
                selections[group] = selections[group].filter(item => item !== value);
            } else {
                // 択一式グループの場合、同じグループの他の選択を解除
                if (exclusiveGroup) {
                    const sameGroupItems = document.querySelectorAll(`[data-exclusive="${exclusiveGroup}"]`);
                    sameGroupItems.forEach(item => {
                        if (item !== element && item.classList.contains('selected')) {
                            const itemCheckbox = item.querySelector('.checkbox');
                            const itemValue = item.dataset.value;
                            
                            itemCheckbox.innerHTML = '';
                            item.classList.remove('selected');
                            selections[group] = selections[group].filter(sel => sel !== itemValue);
                        }
                    });
                }
                
                // 新しい選択を追加
                checkbox.innerHTML = '✓';
                element.classList.add('selected');
                selections[group].push(value);
            }
            
            // 現在のペルソナデータを更新（深いコピーでクロスコンタミネーションを防ぐ）
            const selectionsClone = {};
            Object.keys(selections).forEach(key => {
                selectionsClone[key] = [...selections[key]];
            });
            allPersonaData[currentPersona].selections = selectionsClone;
            
            updateResults();
            updatePersonaTabs();
            saveToLocalStorage();
        }

        function updateResults() {
            const totalSelected = Object.values(selections).reduce((sum, arr) => sum + arr.length, 0);
            document.getElementById('selectedCount').textContent = totalSelected;
            
            // Update individual counts
            document.getElementById('basicCount').textContent = selections.basic.length;
            document.getElementById('valuesCount').textContent = selections.values.length;
            document.getElementById('learningCount').textContent = selections.learning.length;
            document.getElementById('relationshipsCount').textContent = selections.relationships.length;
            document.getElementById('growthCount').textContent = selections.growth.length;
            document.getElementById('episodesCount').textContent = selections.episodes.length;
            
            // Update progress
            const totalGroups = 6;
            const completedGroups = Object.values(selections).filter(arr => arr.length > 0).length;
            const progress = (completedGroups / totalGroups) * 100;
            
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('completionPercent').textContent = Math.round(progress) + '%';
            
            // Update completion dots
            Object.keys(selections).forEach(group => {
                const dot = document.querySelector(`[data-group="${group}"]`);
                if (dot) {
                    if (selections[group].length > 0) {
                        dot.classList.add('filled');
                    } else {
                        dot.classList.remove('filled');
                    }
                }
            });
            
            // Update result displays
            updateResultDisplay('basic', 'basicResults', '基本属性と生活背景');
            updateResultDisplay('values', 'valuesResults', '価値観・判断基準');
            updateResultDisplay('learning', 'learningResults', '学習スタンス');
            updateResultDisplay('relationships', 'relationshipsResults', '他者との関係');
            updateResultDisplay('growth', 'growthResults', '成長の兆し');
            updateResultDisplay('episodes', 'episodesResults', '具体的エピソード');
            
            // Enable/disable generate button
            document.getElementById('generateBtn').disabled = totalSelected === 0;
        }

        function updateResultDisplay(groupKey, elementId, title) {
            const container = document.getElementById(elementId);
            const itemsContainer = container.querySelector('.result-items');
            
            if (selections[groupKey].length === 0) {
                itemsContainer.innerHTML = '<div class="result-item">まだ選択されていません</div>';
            } else {
                itemsContainer.innerHTML = selections[groupKey]
                    .map(item => `<div class="result-item">・${item}</div>`)
                    .join('');
            }
        }

        function generatePrompt() {
            // ローディング状態を開始
            const generateBtn = document.getElementById('generateBtn');
            const originalText = generateBtn.textContent;
            generateBtn.textContent = '⏳ 生成中...';
            generateBtn.disabled = true;
            
            // 処理を少し遅延させてローディング表示を見せる
            setTimeout(() => {
                try {
                    // 現在のペルソナデータを保存
                    saveCurrentPersonaData();
            
            // 複数ペルソナのデータをチェック
            const personasToGenerate = [];
            let hasValidData = false;
            
            for (let i = 1; i <= personaCount; i++) {
                const personaData = allPersonaData[i];
                const totalSelected = Object.values(personaData.selections).reduce((sum, arr) => sum + arr.length, 0);
                const episodeCount = Object.values(personaData.episodes).filter(ep => ep.trim().length > 0).length;
                
                if (totalSelected > 0 || episodeCount > 0) {
                    personasToGenerate.push(i);
                    hasValidData = true;
                }
            }
            
            if (!hasValidData) {
                alert('少なくとも1つのペルソナで属性を選択するか、自由記述欄に記入してください。');
                return;
            }

            let prompt = '';
            
            if (personaCount === 1) {
                // 単一ペルソナの場合（既存の形式）
                const personaData = allPersonaData[1];
                const totalSelected = Object.values(personaData.selections).reduce((sum, arr) => sum + arr.length, 0);
                
                prompt = `# 大学生ペルソナ作成指示

以下の選択された属性に基づいて、リアルで具体的な大学生のペルソナを作成してください。

## 📝 選択された属性一覧

### 🏠 基本属性と生活背景 (${personaData.selections.basic.length}項目選択)
${personaData.selections.basic.length > 0 ? personaData.selections.basic.map(item => `• ${item}`).join('\n') : '• （未選択）'}

### 💭 価値観・判断の基準 (${personaData.selections.values.length}項目選択)
${personaData.selections.values.length > 0 ? personaData.selections.values.map(item => `• ${item}`).join('\n') : '• （未選択）'}

### 📚 学習・知識に対するスタンス (${personaData.selections.learning.length}項目選択)
${personaData.selections.learning.length > 0 ? personaData.selections.learning.map(item => `• ${item}`).join('\n') : '• （未選択）'}

### 🤝 他者との関係 (${personaData.selections.relationships.length}項目選択)
${personaData.selections.relationships.length > 0 ? personaData.selections.relationships.map(item => `• ${item}`).join('\n') : '• （未選択）'}

### 🌱 セルフ・オーサーシップの兆し・成長 (${personaData.selections.growth.length}項目選択)
${personaData.selections.growth.length > 0 ? personaData.selections.growth.map(item => `• ${item}`).join('\n') : '• （未選択）'}

### 📖 具体的エピソード (${personaData.selections.episodes.length}項目選択)
${personaData.selections.episodes.length > 0 ? personaData.selections.episodes.map(item => `• ${item}`).join('\n') : '• （未選択）'}

### ✍️ 自由記述エピソード
${personaData.episodes.episode1 ? `**エピソード1（日常の意思決定）:**\n${personaData.episodes.episode1}\n` : ''}${personaData.episodes.episode2 ? `**エピソード2（学習・成長）:**\n${personaData.episodes.episode2}\n` : ''}${personaData.episodes.episode3 ? `**エピソード3（他者との関係）:**\n${personaData.episodes.episode3}\n` : ''}${!personaData.episodes.episode1 && !personaData.episodes.episode2 && !personaData.episodes.episode3 ? '• （未記入）' : ''}

---

## 🎯 ペルソナ作成指示

上記の選択された属性（合計${totalSelected}項目）と自由記述エピソードを自然に統合し、以下の構成で大学生ペルソナを作成してください。特に自由記述エピソードは具体的な行動や体験として重要視し、ペルソナの核となる特徴やストーリーに反映させてください：

### 1. 基本プロフィール
- 名前（仮名）、年齢、学部学科
- 出身地、居住状況、家族構成
- 外見的特徴、第一印象

### 2. 性格・価値観
- 基本的な性格特性
- 大切にしている価値観
- 判断・選択の基準
- 将来への考え方

### 3. 学習・成長スタンス
- 大学での学びに対する姿勢
- 知識や情報への向き合い方
- 成長や変化への取り組み
- セルフ・オーサーシップの発達段階

### 4. 人間関係・コミュニケーション
- 友人・家族・教員との関係性
- コミュニケーションの特徴
- 他者からの期待への反応
- 集団での立ち位置

### 5. 現在の課題・成長の兆し
- 抱えている悩みや違和感
- 内的な葛藤や迷い
- 最近感じている変化
- 主体性発達の可能性

### 6. 具体的な行動・エピソード
- 日常的な行動パターン
- 印象的な体験・決断
- 成長を示すエピソード
- 人物像を表す具体例

### 7. 成長への示唆
- このペルソナに効果的なアプローチ
- 注意すべき点・配慮事項
- 成長を促すための具体的提案

## 📊 CSV形式での出力とダウンロード

ペルソナの詳細記述が完了したら、以下の**2つの形式**で出力してください：

### 1. CSV形式のデータ表示
以下のCSV形式でデータを表示してください：

\`\`\`csv
名前,年齢,学部学科,出身地,居住状況,経済状況,性格特性,価値観,学習姿勢,人間関係,主な課題,成長の兆し,特徴的エピソード,支援アプローチ
\`\`\`

### 2. CSVファイルのダウンロード提供
**重要**: 上記のCSVデータを、ユーザーが**CSVファイルとしてダウンロード**できるよう出力してください。
- ファイル名の提案：「persona_data_[日付].csv」
- CSVファイルは日本語対応（UTF-8 BOM付き）で出力
- 後続処理での活用を考慮した構造化データとして提供

## ⚠️ 作成時の注意点

- **リアリティ重視**: 実在感があり、大学生として「こんな学生いる！」と感じられる人物像
- **複雑性の表現**: 矛盾や迷いも含めた人間らしい多面性を表現
- **発達途上性**: 固定的でなく、成長・変化の可能性を含む
- **個別性の尊重**: ステレオタイプではなく、唯一無二の個性を持つ人物
- **教育的意味**: 多様な学生像の理解や成長の後押しの検討に具体的に役立つ内容

選択された属性を矛盾なく統合し、教育支援に実際に活用できる詳細で魅力的なペルソナを作成してください。`;
            } else {
                // 複数ペルソナの場合（CSV対応）
                prompt = `# 複数大学生ペルソナ作成指示（CSV出力対応）

以下の${personaCount}名のペルソナ設定に基づいて、リアルで具体的な大学生のペルソナを作成し、**最後にCSV形式でも出力**してください。

`;
                
                // 各ペルソナの詳細を追加
                personasToGenerate.forEach(personaNum => {
                    const personaData = allPersonaData[personaNum];
                    const totalSelected = Object.values(personaData.selections).reduce((sum, arr) => sum + arr.length, 0);
                    
                    prompt += `## 📝 ペルソナ${personaNum}の選択属性（合計${totalSelected}項目）

### 🏠 基本属性と生活背景 (${personaData.selections.basic.length}項目)
${personaData.selections.basic.length > 0 ? personaData.selections.basic.map(item => `• ${item}`).join('\n') : '• （未選択）'}

### 💭 価値観・判断の基準 (${personaData.selections.values.length}項目)
${personaData.selections.values.length > 0 ? personaData.selections.values.map(item => `• ${item}`).join('\n') : '• （未選択）'}

### 📚 学習・知識に対するスタンス (${personaData.selections.learning.length}項目)
${personaData.selections.learning.length > 0 ? personaData.selections.learning.map(item => `• ${item}`).join('\n') : '• （未選択）'}

### 🤝 他者との関係 (${personaData.selections.relationships.length}項目)
${personaData.selections.relationships.length > 0 ? personaData.selections.relationships.map(item => `• ${item}`).join('\n') : '• （未選択）'}

### 🌱 セルフ・オーサーシップの兆し・成長 (${personaData.selections.growth.length}項目)
${personaData.selections.growth.length > 0 ? personaData.selections.growth.map(item => `• ${item}`).join('\n') : '• （未選択）'}

### 📖 具体的エピソード (${personaData.selections.episodes.length}項目)
${personaData.selections.episodes.length > 0 ? personaData.selections.episodes.map(item => `• ${item}`).join('\n') : '• （未選択）'}

### ✍️ 自由記述エピソード
${personaData.episodes.episode1 ? `**エピソード1（日常の意思決定）:**\n${personaData.episodes.episode1}\n` : ''}${personaData.episodes.episode2 ? `**エピソード2（学習・成長）:**\n${personaData.episodes.episode2}\n` : ''}${personaData.episodes.episode3 ? `**エピソード3（他者との関係）:**\n${personaData.episodes.episode3}\n` : ''}${!personaData.episodes.episode1 && !personaData.episodes.episode2 && !personaData.episodes.episode3 ? '• （未記入）' : ''}

---

`;
                });

                prompt += `## 🎯 ペルソナ作成指示

各ペルソナについて、上記の選択された属性と自由記述エピソードを自然に統合し、以下の構成で大学生ペルソナを作成してください：

### 1. 基本プロフィール
- 名前（仮名）、年齢、学部学科
- 出身地、居住状況、家族構成
- 外見的特徴、第一印象

### 2. 性格・価値観
- 基本的な性格特性
- 大切にしている価値観
- 判断・選択の基準
- 将来への考え方

### 3. 学習・成長スタンス
- 大学での学びに対する姿勢
- 知識や情報への向き合い方
- 成長や変化への取り組み
- セルフ・オーサーシップの発達段階

### 4. 人間関係・コミュニケーション
- 友人・家族・教員との関係性
- コミュニケーションの特徴
- 他者からの期待への反応
- 集団での立ち位置

### 5. 現在の課題・成長の兆し
- 抱えている悩みや違和感
- 内的な葛藤や迷い
- 最近感じている変化
- 主体性発達の可能性

### 6. 具体的な行動・エピソード
- 日常的な行動パターン
- 印象的な体験・決断
- 成長を示すエピソード
- 人物像を表す具体例

### 7. 成長への示唆
- このペルソナに効果的なアプローチ
- 注意すべき点・配慮事項
- 成長を促すための具体的提案

## 📊 CSV形式での出力とダウンロード

ペルソナの詳細記述が完了したら、以下の**2つの形式**で出力してください：

### 1. CSV形式のデータ表示
以下のCSV形式でデータを表示してください：

\`\`\`csv
名前,年齢,学部学科,出身地,居住状況,経済状況,性格特性,価値観,学習姿勢,人間関係,主な課題,成長の兆し,特徴的エピソード,支援アプローチ
\`\`\`

### 2. CSVファイルのダウンロード提供
**重要**: 上記のCSVデータを、ユーザーが**CSVファイルとしてダウンロード**できるよう出力してください。
- ファイル名の提案：「persona_data_[日付].csv」
- CSVファイルは日本語対応（UTF-8 BOM付き）で出力
- 後続処理での活用を考慮した構造化データとして提供

## ⚠️ 作成時の注意点

- **リアリティ重視**: 実在感があり、大学生として「こんな学生いる！」と感じられる人物像
- **複雑性の表現**: 矛盾や迷いも含めた人間らしい多面性を表現
- **発達途上性**: 固定的でなく、成長・変化の可能性を含む
- **個別性の尊重**: ステレオタイプではなく、唯一無二の個性を持つ人物
- **多様性の確保**: ${personaCount}名それぞれが異なる個性を持つよう配慮
- **教育的意味**: 多様な学生像の理解や成長の後押しの検討に具体的に役立つ内容

選択された属性を矛盾なく統合し、教育支援に実際に活用できる詳細で魅力的なペルソナを作成してください。`;
            }

                    document.getElementById('exportText').value = prompt;
                    document.getElementById('exportArea').style.display = 'block';
                    
                    // 案内メッセージを表示
                    showGenerationMessage();
                    
                } catch (error) {
                    console.error('プロンプト生成エラー:', error);
                    alert('プロンプトの生成中にエラーが発生しました。');
                } finally {
                    // プロンプト生成完了の通知
                    generateBtn.textContent = '✅ 生成完了！';
                    generateBtn.style.background = '#10b981';
                    generateBtn.disabled = false;
                    
                    setTimeout(() => {
                        generateBtn.textContent = originalText;
                        generateBtn.style.background = '';
                    }, 2000);
                }
            }, 300); // 300ms の遅延
        }

        function showGenerationMessage() {
            // メッセージエリアを作成または取得
            let messageArea = document.getElementById('generation-message');
            if (!messageArea) {
                messageArea = document.createElement('div');
                messageArea.id = 'generation-message';
                messageArea.style.cssText = `
                    background: linear-gradient(90deg, #4f46e5, #7c3aed);
                    color: white;
                    padding: 15px 20px;
                    margin: 15px 0;
                    border-radius: 10px;
                    text-align: center;
                    font-weight: 600;
                    box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
                    animation: fadeInUp 0.5s ease-out;
                `;
                
                // exportAreaの直前に挿入
                const exportArea = document.getElementById('exportArea');
                exportArea.parentNode.insertBefore(messageArea, exportArea);
            }
            
            messageArea.innerHTML = '📋 下の生成AI用プロンプトのセクションを確認してください';
            messageArea.style.display = 'block';
            
            // 5秒後にメッセージを自動で非表示
            setTimeout(() => {
                if (messageArea) {
                    messageArea.style.opacity = '0';
                    messageArea.style.transform = 'translateY(-10px)';
                    setTimeout(() => {
                        if (messageArea && messageArea.parentNode) {
                            messageArea.style.display = 'none';
                        }
                    }, 300);
                }
            }, 5000);
        }

        function randomSelection() {
            // 確認ダイアログ
            if (!confirm('ランダム選択を実行しますか？\n各サブセクションから最低1つずつ自動選択されます。\n現在の選択はリセットされます。')) {
                return;
            }

            // 現在の選択をクリア
            clearAllSelections();

            // 選択対象の要素を収集
            const optionsToSelect = [];

            // 各カテゴリのサブセクションごとに選択肢を収集
            document.querySelectorAll('.attribute-group').forEach(group => {
                const groupType = group.dataset.group;
                
                // サブセクションを特定（h3タグで区切られた領域）
                const subsections = [];
                let currentSubsection = [];
                
                const allElements = group.querySelectorAll('.group-content > *');
                
                allElements.forEach(element => {
                    if (element.tagName === 'H3') {
                        // 新しいサブセクションの開始
                        if (currentSubsection.length > 0) {
                            subsections.push(currentSubsection);
                        }
                        currentSubsection = [];
                    } else if (element.classList.contains('option-item') && element.dataset.value) {
                        // 選択可能な項目
                        currentSubsection.push(element);
                    }
                });
                
                // 最後のサブセクションを追加
                if (currentSubsection.length > 0) {
                    subsections.push(currentSubsection);
                }
                
                // 各サブセクションから1つずつ選択
                subsections.forEach(subsection => {
                    if (subsection.length > 0) {
                        // ランダムに1つ選択
                        const randomIndex = Math.floor(Math.random() * subsection.length);
                        const selectedOption = subsection[randomIndex];
                        optionsToSelect.push(selectedOption);
                    }
                });
                
                // 追加で各カテゴリから0-2個をランダム選択（バリエーションを増やすため）
                // ただし、択一式グループは除く
                const allOptionsInGroup = group.querySelectorAll('.option-item[data-value]');
                const unselectedOptions = Array.from(allOptionsInGroup).filter(option => 
                    !optionsToSelect.includes(option) && !option.dataset.exclusive
                );
                
                if (unselectedOptions.length > 0) {
                    const additionalCount = Math.floor(Math.random() * 3); // 0-2個追加
                    const shuffled = [...unselectedOptions].sort(() => Math.random() - 0.5);
                    const additionalSelections = shuffled.slice(0, Math.min(additionalCount, unselectedOptions.length));
                    
                    additionalSelections.forEach(option => {
                        optionsToSelect.push(option);
                    });
                }
            });

            // 収集した要素をtoggleOption関数を使って正しく選択
            optionsToSelect.forEach(option => {
                if (option && !option.classList.contains('selected')) {
                    toggleOption(option);
                }
            });
            
            // ランダム選択後にすべてのセクションを展開
            expandAllSections();
            
            // 完了通知
            const randomBtn = event.target;
            const originalText = randomBtn.textContent;
            randomBtn.textContent = '🎲 選択完了！';
            randomBtn.style.background = '#3b82f6';
            randomBtn.style.color = 'white';
            
            setTimeout(() => {
                randomBtn.textContent = originalText;
                randomBtn.style.background = '';
                randomBtn.style.color = '';
            }, 2000);
        }

        function clearAllSelections() {
            // 選択データをクリア
            selections = {
                basic: [],
                values: [],
                learning: [],
                relationships: [],
                growth: [],
                episodes: []
            };
            
            // UI要素をリセット（正しいチェックマーク処理方法を使用）
            document.querySelectorAll('.option-item').forEach(item => {
                item.classList.remove('selected');
                const checkbox = item.querySelector('.checkbox');
                if (checkbox) {
                    checkbox.innerHTML = ''; // チェックマークを削除
                }
            });
            
            // 現在のペルソナデータを更新
            const selectionsClone = {};
            Object.keys(selections).forEach(key => {
                selectionsClone[key] = [...selections[key]];
            });
            allPersonaData[currentPersona].selections = selectionsClone;
            
            // データ保存とUI更新
            updateResults();
            updatePersonaTabs();
            saveToLocalStorage();
        }

        function clearAll() {
            if (confirm('すべての選択をリセットしますか？')) {
                clearAllSelections();
                document.getElementById('exportArea').style.display = 'none';
                updateResults();
                
                // 完了通知
                const clearBtn = event.target;
                const originalText = clearBtn.textContent;
                clearBtn.textContent = '🗑️ リセット完了';
                clearBtn.style.background = '#ef4444';
                clearBtn.style.color = 'white';
                
                setTimeout(() => {
                    clearBtn.textContent = originalText;
                    clearBtn.style.background = '';
                    clearBtn.style.color = '';
                }, 2000);
            }
        }

        // Search toggle functionality
        function toggleSearch() {
            const searchBox = document.getElementById('searchBox');
            const searchToggle = document.getElementById('searchToggle');
            
            if (searchBox.classList.contains('active')) {
                closeSearch();
            } else {
                searchBox.classList.add('active');
                searchToggle.innerHTML = '×';
                setTimeout(() => {
                    document.getElementById('searchInput').focus();
                }, 300);
            }
        }

        function closeSearch() {
            const searchBox = document.getElementById('searchBox');
            const searchToggle = document.getElementById('searchToggle');
            const searchInput = document.getElementById('searchInput');
            
            searchBox.classList.remove('active');
            searchToggle.innerHTML = '🔍';
            searchInput.value = '';
            
            // Clear search results
            const options = document.querySelectorAll('.option-item');
            options.forEach(option => {
                option.style.display = 'flex';
            });
        }

        // Close search with Escape key
        // ページ読み込み時の初期化
        document.addEventListener('DOMContentLoaded', function() {
            // LocalStorageからデータを復元
            if (!loadFromLocalStorage()) {
                // 初回アクセスの場合、初期化
                selections = allPersonaData[1].selections;
                updateProgress();
            }
            
            // 自由記述欄の変更イベント監視
            const episodeInputs = ['episode1Custom', 'episode2Custom', 'episode3Custom'];
            episodeInputs.forEach(inputId => {
                const input = document.getElementById(inputId);
                if (input) {
                    input.addEventListener('input', function() {
                        saveCurrentPersonaData();
                        updatePersonaTabs();
                        saveToLocalStorage();
                    });
                }
            });
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeSearch();
                return;
            }
            
            // タブ間のキーボードナビゲーション
            if (personaCount > 1) {
                const focusedElement = document.activeElement;
                if (focusedElement && focusedElement.classList.contains('persona-tab')) {
                    if (e.key === 'ArrowLeft') {
                        e.preventDefault();
                        const currentPersonaNum = parseInt(focusedElement.dataset.persona);
                        const prevPersona = currentPersonaNum > 1 ? currentPersonaNum - 1 : personaCount;
                        document.getElementById(`persona-tab-${prevPersona}`).focus();
                    } else if (e.key === 'ArrowRight') {
                        e.preventDefault();
                        const currentPersonaNum = parseInt(focusedElement.dataset.persona);
                        const nextPersona = currentPersonaNum < personaCount ? currentPersonaNum + 1 : 1;
                        document.getElementById(`persona-tab-${nextPersona}`).focus();
                    } else if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        const personaNum = parseInt(focusedElement.dataset.persona);
                        switchPersona(personaNum);
                    }
                }
            }
            
            // ペルソナ数選択ボタンのキーボードナビゲーション
            if (focusedElement && focusedElement.classList.contains('persona-count-btn')) {
                if (e.key === 'ArrowLeft') {
                    e.preventDefault();
                    const currentCount = parseInt(focusedElement.dataset.count);
                    const prevCount = currentCount > 1 ? currentCount - 1 : 5;
                    document.querySelector(`[data-count="${prevCount}"]`).focus();
                } else if (e.key === 'ArrowRight') {
                    e.preventDefault();
                    const currentCount = parseInt(focusedElement.dataset.count);
                    const nextCount = currentCount < 5 ? currentCount + 1 : 1;
                    document.querySelector(`[data-count="${nextCount}"]`).focus();
                } else if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    const count = parseInt(focusedElement.dataset.count);
                    setPersonaCount(count);
                }
            }
        });

        // Search functionality with debouncing
        let searchTimeout;
        document.getElementById('searchInput').addEventListener('input', function(e) {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                const searchTerm = e.target.value.toLowerCase();
                const options = document.querySelectorAll('.option-item');
                
                if (searchTerm === '') {
                    // 検索語が空の場合、すべて表示
                    options.forEach(option => {
                        option.style.display = 'flex';
                    });
                } else {
                    // 検索語がある場合、フィルタリング
                    options.forEach(option => {
                        const text = option.textContent.toLowerCase();
                        if (text.includes(searchTerm)) {
                            option.style.display = 'flex';
                        } else {
                            option.style.display = 'none';
                        }
                    });
                }
                
                // 検索結果の統計を更新
                updateSearchStats(searchTerm);
            }, 150); // 150ms のデバウンス
        });

        // 検索結果統計の更新
        function updateSearchStats(searchTerm) {
            if (searchTerm === '') return;
            
            const options = document.querySelectorAll('.option-item');
            const visibleOptions = Array.from(options).filter(option => 
                option.style.display !== 'none'
            );
            
            // 検索結果数を表示（UI要素があれば）
            const searchStats = document.getElementById('searchStats');
            if (searchStats) {
                searchStats.textContent = `${visibleOptions.length}件の結果`;
            }
        }

        function copyPrompt() {
            const textarea = document.getElementById('exportText');
            textarea.select();
            textarea.setSelectionRange(0, 99999); // For mobile devices
            
            try {
                document.execCommand('copy');
                
                // 成功通知とアニメーション
                const copyBtn = event.target;
                const originalText = copyBtn.textContent;
                copyBtn.textContent = '✅ コピー完了！';
                copyBtn.style.background = '#10b981';
                copyBtn.style.transform = 'scale(1.05)';
                copyBtn.style.boxShadow = '0 4px 15px rgba(16, 185, 129, 0.3)';
                
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                    copyBtn.style.background = '';
                    copyBtn.style.transform = '';
                    copyBtn.style.boxShadow = '';
                }, 2000);
                
            } catch (err) {
                // フォールバック：手動選択を促す
                alert('コピーに失敗しました。テキストを手動で選択してCtrl+C（Mac: Cmd+C）でコピーしてください。');
            }
        }

        // Initialize
        updateResults();
    </script>
</body>
</html>
